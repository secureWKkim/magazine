<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ìˆ˜ìŠµ ê³¼ì œ: Aì‚¬ 3ì›”~7ì›” ë°ì´í„° adhoc êµ¬ì¶• | Eyes can blaze like Meteors!ğŸŒ </title>

    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>ìˆ˜ìŠµ ê³¼ì œ: Aì‚¬ 3ì›”~7ì›” ë°ì´í„° adhoc êµ¬ì¶• | Eyes can blaze like Meteors!ğŸŒ </title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="ìˆ˜ìŠµ ê³¼ì œ: Aì‚¬ 3ì›”~7ì›” ë°ì´í„° adhoc êµ¬ì¶•" />
<meta name="author" content="jane" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="1. í”„ë¡œì íŠ¸ ê°œìš”" />
<meta property="og:description" content="1. í”„ë¡œì íŠ¸ ê°œìš”" />
<link rel="canonical" href="http://localhost:4000/magazine/adhoc-bigdata-loading/" />
<meta property="og:url" content="http://localhost:4000/magazine/adhoc-bigdata-loading/" />
<meta property="og:site_name" content="Eyes can blaze like Meteors!ğŸŒ " />
<meta property="og:image" content="http://localhost:4000/magazine/assets/images/6.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-09-27T00:00:00+09:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/magazine/assets/images/6.jpg" />
<meta property="twitter:title" content="ìˆ˜ìŠµ ê³¼ì œ: Aì‚¬ 3ì›”~7ì›” ë°ì´í„° adhoc êµ¬ì¶•" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"jane"},"dateModified":"2025-09-27T00:00:00+09:00","datePublished":"2025-09-27T00:00:00+09:00","description":"1. í”„ë¡œì íŠ¸ ê°œìš”","headline":"ìˆ˜ìŠµ ê³¼ì œ: Aì‚¬ 3ì›”~7ì›” ë°ì´í„° adhoc êµ¬ì¶•","image":"http://localhost:4000/magazine/assets/images/6.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/magazine/adhoc-bigdata-loading/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/magazine/assets/images/logo.png"},"name":"jane"},"url":"http://localhost:4000/magazine/adhoc-bigdata-loading/"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="shortcut icon" type="image/x-icon" href="/magazine/assets/images/favicon.ico">

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

    <!-- Google Fonts-->
    <link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700" rel="stylesheet">

    <!-- Bootstrap Modified -->
    <link rel="stylesheet" href="/magazine/assets/css/main.css">

    <!-- Theme Stylesheet -->
    <link rel="stylesheet" href="/magazine/assets/css/theme.css">

    <!-- Jquery on header to make sure everything works, the rest  of the scripts in footer for fast loading -->
    <script
    src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>

    <!-- This goes before </head> closing tag, Google Analytics can be placed here --> 


</head>

<body class="">

    <!-- Navbar -->
    <nav id="MagicMenu" class="topnav navbar navbar-expand-lg navbar-light bg-white fixed-top">
    <div class="container">
        <a class="navbar-brand" href="/magazine/index.html"><strong>Eyes can blaze like Meteors!ğŸŒ </strong></a>
        <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarColor02" aria-controls="navbarColor02" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
        </button>
        <div class="navbar-collapse collapse" id="navbarColor02" style="">
            <ul class="navbar-nav mr-auto d-flex align-items-center">
               <!--  Replace menu links here -->

<li class="nav-item">
<a class="nav-link" href="/magazine/index.html">Home</a>
</li>
<li class="nav-item">
<a class="nav-link" href="/magazine/authors-list.html">Authors</a>
</li>
<li class="nav-item">
<a class="nav-link" href="/magazine/contact.html">Contact</a>
</li>
<li class="nav-item">
<a target="_blank" class="nav-link" href="https://www.wowthemes.net/themes/mundana-wordpress/">WP</a>
</li>
<li class="nav-item">
<a target="_blank" class="nav-link" href="https://www.wowthemes.net/themes/mundana-ghost/">Ghost</a>
</li>
<li class="nav-item">
<a target="_blank" class="nav-link" href="https://www.wowthemes.net/donate/">Buy me a coffee <i class="fa fa-coffee text-danger"></i></a>
</li>

            </ul>
            <ul class="navbar-nav ml-auto d-flex align-items-center">
                <script src="/magazine/assets/js/lunr.js"></script>

<script>
$(function() {
    $("#lunrsearchresults").on('click', '#btnx', function () {
        $('#lunrsearchresults').hide( 1000 );
        $( "body" ).removeClass( "modal-open" );
    });
});
    

var documents = [{
    "id": 0,
    "url": "http://localhost:4000/magazine/404/",
    "title": "",
    "body": " 404 Page not found :(  The requested page could not be found. "
    }, {
    "id": 1,
    "url": "http://localhost:4000/magazine/about.html",
    "title": "About",
    "body": "Made with by Sal @wowthemesnet. "
    }, {
    "id": 2,
    "url": "http://localhost:4000/magazine/author-dr-meteor.html",
    "title": "Dr.Meteor",
    "body": "                        {{page. title}} Follow:         {{ site. authors. jane. site }}         {{ site. authors. jane. bio }}                                   Posts by {{page. title}}:       {% assign posts = site. posts | where: author , jane  %}      {% for post in posts %}      {% include main-loop-card. html %}      {% endfor %}  "
    }, {
    "id": 3,
    "url": "http://localhost:4000/magazine/author-sal.html",
    "title": "Sal",
    "body": "                        {{page. title}} Follow:         {{ site. authors. sal. site }}         {{ site. authors. sal. bio }}                                   Posts by {{page. title}}:       {% assign posts = site. posts | where: author , sal  %}      {% for post in posts %}      {% include main-loop-card. html %}      {% endfor %}  "
    }, {
    "id": 4,
    "url": "http://localhost:4000/magazine/authors-list.html",
    "title": "Authors",
    "body": "{{page. title}}:     {% for author in site. authors %}                                         {{ author[1]. name }} :       (View Posts)      {{ author[1]. bio }}                          &nbsp;       &nbsp;                                    {% endfor %}  "
    }, {
    "id": 5,
    "url": "http://localhost:4000/magazine/buy-me-a-coffee.html",
    "title": "Buy me a coffee",
    "body": "Hi! I am Sal, web designer &amp; developer at WowThemes. net. The free items I create are my side projects and Mundana for Jekyll is one of them. You can find all the work I release for free here. You have my permission to use the free items I develop in your personal, commercial or client projects. If youâ€™d like to reward my work, I would be honored and I could dedicate more time maintaining the free projects. Thank you so much! Buy me a coffee "
    }, {
    "id": 6,
    "url": "http://localhost:4000/magazine/categories.html",
    "title": "Categories",
    "body": "          Categories          {% for category in site. categories %}     {{ category[0] }}:           {% assign pages_list = category[1] %}    {% for post in pages_list %}    {% if post. title != null %}     {% if group == null or group == post. group %}           {% include main-loop-card. html %}     {% endif %}    {% endif %}    {% endfor %}    {% assign pages_list = nil %}    {% assign group = nil %}    {% endfor %}                  {% include sidebar-featured. html %}          "
    }, {
    "id": 7,
    "url": "http://localhost:4000/magazine/contact.html",
    "title": "Contact",
    "body": "  Please send your message to {{site. name}}. We will reply as soon as possible!   "
    }, {
    "id": 8,
    "url": "http://localhost:4000/magazine/",
    "title": "Mundana Free Jekyll Theme",
    "body": "  {% if page. url ==  /  %}            {% assign latest_post = site. posts[0] %}          &lt;div class= topfirstimage  style= background-image: url({% if latest_post. image contains  ://  %}{{ latest_post. image }}{% else %} {{site. baseurl}}/{{ latest_post. image}}{% endif %}); height: 200px;  background-size: cover;  background-repeat: no-repeat; &gt;&lt;/div&gt;           {{ latest_post. title }}  :       {{ latest_post. excerpt | strip_html | strip_newlines | truncate: 136 }}               In         {% for category in latest_post. categories %}        {{ category }},         {% endfor %}                                {{ latest_post. date | date: '%b %d, %Y' }}                            {%- assign second_post = site. posts[1] -%}                        {% if second_post. image %}                         &lt;img class= w-100  src= {% if second_post. image contains  ://  %}{{ second_post. image }}{% else %}{{ second_post. image | absolute_url }}{% endif %}  alt= {{ second_post. title }} &gt;                        {% endif %}                                    {{ second_post. title }}          :                       In             {% for category in second_post. categories %}            {{ category }},             {% endfor %}                                                      {{ second_post. date | date: '%b %d, %Y' }}                                    {%- assign third_post = site. posts[2] -%}                        {% if third_post. image %}                         &lt;img class= w-100  src= {% if third_post. image contains  ://  %}{{ third_post. image }}{% else %}{{site. baseurl}}/{{ third_post. image }}{% endif %}  alt= {{ third_post. title }} &gt;                        {% endif %}                                    {{ third_post. title }}          :                       In             {% for category in third_post. categories %}            {{ category }},             {% endfor %}                                                      {{ third_post. date | date: '%b %d, %Y' }}                                    {%- assign fourth_post = site. posts[3] -%}                        {% if fourth_post. image %}                        &lt;img class= w-100  src= {% if fourth_post. image contains  ://  %}{{ fourth_post. image }}{% else %}{{site. baseurl}}/{{ fourth_post. image }}{% endif %}  alt= {{ fourth_post. title }} &gt;                        {% endif %}                                    {{ fourth_post. title }}          :                       In             {% for category in fourth_post. categories %}            {{ category }},             {% endfor %}                                                      {{ fourth_post. date | date: '%b %d, %Y' }}                                  {% for post in site. posts %} {% if post. tags contains  sticky  %}                    {{post. title}}                  {{ post. excerpt | strip_html | strip_newlines | truncate: 136 }}                 Read More            	             {% endif %}{% endfor %}  {% endif %}                All Stories:         {% for post in paginator. posts %}          {% include main-loop-card. html %}        {% endfor %}                   {% if paginator. total_pages &gt; 1 %}              {% if paginator. previous_page %}        &laquo; Prev       {% else %}        &laquo;       {% endif %}       {% for page in (1. . paginator. total_pages) %}        {% if page == paginator. page %}        {{ page }}        {% elsif page == 1 %}        {{ page }}        {% else %}        {{ page }}        {% endif %}       {% endfor %}       {% if paginator. next_page %}        Next &raquo;       {% else %}        &raquo;       {% endif %}            {% endif %}                     {% include sidebar-featured. html %}      "
    }, {
    "id": 9,
    "url": "http://localhost:4000/magazine/privacy-policy.html",
    "title": "Privacy Policy",
    "body": "â€{{site. name}}â€ takes your privacy seriously. To better protect your privacy we provide this privacy policy notice explaining the way your personal information is collected and used. Collection of Routine Information: This website track basic information about their visitors. This information includes, but is not limited to, IP addresses, browser details, timestamps and referring pages. None of this information can personally identify specific visitor to this website. The information is tracked for routine administration and maintenance purposes. Cookies: Where necessary, this website uses cookies to store information about a visitorâ€™s preferences and history in order to better serve the visitor and/or present the visitor with customized content. Advertisement and Other Third Parties: Advertising partners and other third parties may use cookies, scripts and/or web beacons to track visitor activities on this website in order to display advertisements and other useful information. Such tracking is done directly by the third parties through their own servers and is subject to their own privacy policies. This website has no access or control over these cookies, scripts and/or web beacons that may be used by third parties. Learn how to opt out of Googleâ€™s cookie usage. Links to Third Party Websites: We have included links on this website for your use and reference. We are not responsible for the privacy policies on these websites. You should be aware that the privacy policies of these websites may differ from our own. Security: The security of your personal information is important to us, but remember that no method of transmission over the Internet, or method of electronic storage, is 100% secure. While we strive to use commercially acceptable means to protect your personal information, we cannot guarantee its absolute security. Changes To This Privacy Policy: This Privacy Policy is effective and will remain in effect except with respect to any changes in its provisions in the future, which will be in effect immediately after being posted on this page. We reserve the right to update or change our Privacy Policy at any time and you should check this Privacy Policy periodically. If we make any material changes to this Privacy Policy, we will notify you either through the email address you have provided us, or by placing a prominent notice on our website. Contact Information: For any questions or concerns regarding the privacy policy, please contact us here. "
    }, {
    "id": 10,
    "url": "http://localhost:4000/magazine/tags.html",
    "title": "Tags",
    "body": "          Tags          {% for tag in site. tags %}     {{ tag[0] }}:           {% assign pages_list = tag[1] %}    {% for post in pages_list %}    {% if post. title != null %}     {% if group == null or group == post. group %}           {% include main-loop-card. html %}     {% endif %}    {% endif %}    {% endfor %}    {% assign pages_list = nil %}    {% assign group = nil %}    {% endfor %}                  {% include sidebar-featured. html %}          "
    }, {
    "id": 11,
    "url": "http://localhost:4000/magazine/robots.txt",
    "title": "",
    "body": "      Sitemap: {{ â€œsitemap. xmlâ€   absolute_url }}   "
    }, {
    "id": 12,
    "url": "http://localhost:4000/magazine/page2/",
    "title": "Mundana Free Jekyll Theme",
    "body": "  {% if page. url ==  /  %}            {% assign latest_post = site. posts[0] %}          &lt;div class= topfirstimage  style= background-image: url({% if latest_post. image contains  ://  %}{{ latest_post. image }}{% else %} {{site. baseurl}}/{{ latest_post. image}}{% endif %}); height: 200px;  background-size: cover;  background-repeat: no-repeat; &gt;&lt;/div&gt;           {{ latest_post. title }}  :       {{ latest_post. excerpt | strip_html | strip_newlines | truncate: 136 }}               In         {% for category in latest_post. categories %}        {{ category }},         {% endfor %}                                {{ latest_post. date | date: '%b %d, %Y' }}                            {%- assign second_post = site. posts[1] -%}                        {% if second_post. image %}                         &lt;img class= w-100  src= {% if second_post. image contains  ://  %}{{ second_post. image }}{% else %}{{ second_post. image | absolute_url }}{% endif %}  alt= {{ second_post. title }} &gt;                        {% endif %}                                    {{ second_post. title }}          :                       In             {% for category in second_post. categories %}            {{ category }},             {% endfor %}                                                      {{ second_post. date | date: '%b %d, %Y' }}                                    {%- assign third_post = site. posts[2] -%}                        {% if third_post. image %}                         &lt;img class= w-100  src= {% if third_post. image contains  ://  %}{{ third_post. image }}{% else %}{{site. baseurl}}/{{ third_post. image }}{% endif %}  alt= {{ third_post. title }} &gt;                        {% endif %}                                    {{ third_post. title }}          :                       In             {% for category in third_post. categories %}            {{ category }},             {% endfor %}                                                      {{ third_post. date | date: '%b %d, %Y' }}                                    {%- assign fourth_post = site. posts[3] -%}                        {% if fourth_post. image %}                        &lt;img class= w-100  src= {% if fourth_post. image contains  ://  %}{{ fourth_post. image }}{% else %}{{site. baseurl}}/{{ fourth_post. image }}{% endif %}  alt= {{ fourth_post. title }} &gt;                        {% endif %}                                    {{ fourth_post. title }}          :                       In             {% for category in fourth_post. categories %}            {{ category }},             {% endfor %}                                                      {{ fourth_post. date | date: '%b %d, %Y' }}                                  {% for post in site. posts %} {% if post. tags contains  sticky  %}                    {{post. title}}                  {{ post. excerpt | strip_html | strip_newlines | truncate: 136 }}                 Read More            	             {% endif %}{% endfor %}  {% endif %}                All Stories:         {% for post in paginator. posts %}          {% include main-loop-card. html %}        {% endfor %}                   {% if paginator. total_pages &gt; 1 %}              {% if paginator. previous_page %}        &laquo; Prev       {% else %}        &laquo;       {% endif %}       {% for page in (1. . paginator. total_pages) %}        {% if page == paginator. page %}        {{ page }}        {% elsif page == 1 %}        {{ page }}        {% else %}        {{ page }}        {% endif %}       {% endfor %}       {% if paginator. next_page %}        Next &raquo;       {% else %}        &raquo;       {% endif %}            {% endif %}                     {% include sidebar-featured. html %}      "
    }, {
    "id": 13,
    "url": "http://localhost:4000/magazine/adhoc-bigdata-loading/",
    "title": "ìˆ˜ìŠµ ê³¼ì œ: Aì‚¬ 3ì›”~7ì›” ë°ì´í„° adhoc êµ¬ì¶•",
    "body": "2025/09/27 - 1. í”„ë¡œì íŠ¸ ê°œìš”1. 1 í”„ë¡œì íŠ¸ ëª©ì :  ëª©ì : ìš´ì˜ í™˜ê²½ DBì—ì„œ ?? ì²˜ë¦¬í•˜ê¸°ì—” ë°ì´í„°ê°€ ë„ˆë¬´ ë§ì•„ íŠ¹ì • ê¸°ê°„ì˜ ë°ì´í„°ë¥¼ ì¶”ì¶œ ì£¼ìš” Mission: ì‹œê°„ íš¨ìœ¨ ìµœìš°ì„ . ìš´ì˜ ì¸ë±ìŠ¤(timestamp, actor_id)ì™€ íŒŒí‹°ì…”ë‹ í™œìš© êµ¬í˜„ ì „ëµ: ì›”(íŒŒí‹°ì…˜) ë‹¨ìœ„ â†’ í‚¤ì…‹ í˜ì´ì§€ë„¤ì´ì…˜ â†’ COPY ìŠ¤íŠ¸ë¦¬ë° â†’ íƒ€ê¹ƒì— ì ì¬ ê²€ì¦: EXPLAIN rows ì¶”ì •ì¹˜ë§Œ ë¡œê·¸ë¡œ (ê°€ë³ê²Œ) ì¤‘ë³µ ì œì–´: ê¸°ë³¸ OFF(ìµœëŒ€ ì†ë„). í•„ìš” ì‹œ í›„ì²˜ë¦¬ SQL ë³„ë„ ì‹¤í–‰. 1. 2 ìˆ˜í–‰ ë²”ìœ„: 1. 3 ê¸°ìˆ  ìŠ¤íƒ ë° í™˜ê²½: 2. Sample Test í™˜ê²½ êµ¬ì„± ë° ìš´ì˜2. 1 Source DB / Stage DB / Airflow ì»¨í…Œì´ë„ˆ ì •ì˜: ğŸ”¹ Source DB (ì›ì²œ DB):  êµ¬ì„±: íšŒì‚¬ ë‚´ë¶€ PostgreSQL 16 ì„œë²„ (ì™¸ë¶€ì— ë³„ë„ ì»¨í…Œì´ë„ˆ ì—†ìŒ) ì ‘ì†ë°©ì‹: SRC_PG_HOST, SRC_PG_PORT, SRC_PG_DB, SRC_PG_USER, SRC_PG_PASSWORD í™˜ê²½ë³€ìˆ˜ë¡œ ëª¨ë“  ì„œë¹„ìŠ¤ì— ê³µí†µ ì£¼ì… Airflow Connection: AIRFLOW_CONN_SRC_PG URIë¥¼ í†µí•´ DAG ë‚´ Operatorë“¤ì´ ì ‘ê·¼ğŸ”¹ Stage DB (ì ì¬ DB, ë¡œì»¬ ì»¨í…Œì´ë„ˆ):  êµ¬ì„±: pg_stage (Postgres 13 ì»¨í…Œì´ë„ˆ) í™˜ê²½ë³€ìˆ˜: STG_PG_USER, STG_PG_PASSWORD, STG_PG_DB í¬íŠ¸ ë§¤í•‘: í˜¸ìŠ¤íŠ¸ 5434 â†’ ì»¨í…Œì´ë„ˆ 5432 ë°ì´í„° ì €ì¥ì†Œ: pg-stage-data ë³¼ë¥¨ ë§ˆìš´íŠ¸ í—¬ìŠ¤ì²´í¬: pg_isready ê¸°ë°˜ DB ì—°ê²° ìƒíƒœ ì ê²€ğŸ”¹ Airflow êµ¬ì„± (ETL ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜):  ê³µí†µ ì„¤ì •: x-airflow-common ì•µì»¤ ì •ì˜ë¡œ Executor, Broker, Backend, Volumes ë“± ì¼ê´„ ì ìš©     Executor: CeleryExecutor   Broker: Redis   Result Backend: Postgres (airflow ë©”íƒ€DB)   Volumes: dags, logs, plugins, config ê³µìœ     ì„œë¹„ìŠ¤ë³„ ì»¨í…Œì´ë„ˆ     airflow-webserver: UI ì œê³µ (í¬íŠ¸ 8080)   airflow-scheduler: DAG ìŠ¤ì¼€ì¤„ë§   airflow-worker: Celery ê¸°ë°˜ ì‘ì—… ì‹¤í–‰   airflow-triggerer: ì´ë²¤íŠ¸ ê¸°ë°˜ íŠ¸ë¦¬ê±° ê´€ë¦¬   airflow-init: ì´ˆê¸° DB ë§ˆì´ê·¸ë ˆì´ì…˜ ë° ê³„ì • ìƒì„±   airflow-cli: ë””ë²„ê¹…ìš© CLI   flower: Celery ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ (í¬íŠ¸ 5555)    ì˜ì¡´ì„± ê´€ë¦¬:     ëª¨ë“  Airflow ì„œë¹„ìŠ¤ëŠ” postgres, redis, pg-remote-probe, pg_stage ìƒíƒœì— ë”°ë¼ ê¸°ë™   3. BigData TESTìš© DB ê´€ë ¨ ì‘ì—…3. 1 PostgreSQL í™˜ê²½ êµ¬ì¶• (ìŠ¤í‚¤ë§ˆ ë° í…Œì´ë¸” ì´ˆê¸°í™”): 3. 1. 1. DBì„œë²„ ì‹¤í–‰ í™˜ê²½:  ì§ì ‘ ì„¤ì¹˜ (ë„ì»¤ ì»¨í…Œì´ë„ˆ ì‚¬ìš© x) ì„œë²„ ì‚¬ì–‘     Ubuntu 24. 02, 4Core CPU, 8GB RAM, 500GB HDD    PostgreSQL 16 (Concern: ìš´ì˜ê³„ DB ë²„ì „ì€ 13ì¸ ê±¸ ê³ ë ¤í•˜ì§€ ëª»í•¨)3. 1. 2 DB ì¸ìŠ¤í„´ìŠ¤ ì„¤ì • ë³€ê²½:  data_directory ê²½ë¡œ ë³€ê²½(íšŒì‚¬ íŒŒí‹°ì…˜ ì„œë²„ì„ì„ ê°ì•ˆ), ì™¸ë¶€ ì ‘ì† í—ˆìš©(listen_address), ì‚¬ìš©ì ê³„ì • ìƒì„±3. 1. 3 ìŠ¤í‚¤ë§ˆ êµ¬ì¡° ì •ì˜:  ì›ì²œ DB í…Œì´ë¸”CREATE TABLE acid. lrs_statement_new (  timestamp  timestamptz NOT NULL, full_statement jsonb NOT NULL, actor_id bigint) PARTITION BY RANGE ( timestamp );CREATE TABLE acid. lrs_statement_2025_03 PARTITION OF acid. lrs_statement_new FOR VALUES FROM ('2025-03-01') TO ('2025-04-01');. . . CREATE TABLE acid. lrs_statement_2025_07 PARTITION OF acid. lrs_statement_new FOR VALUES FROM ('2025-07-01') TO ('2025-08-01'); ì›ì²œ DB ì¸ë±ìŠ¤-- 1) ìì‹ íŒŒí‹°ì…˜ ì¸ë±ìŠ¤ ìƒì„± (CONCURRENTLY)CREATE INDEX CONCURRENTLY IF NOT EXISTS lrs_statement_03_ts_actor_idx ON acid. lrs_statement_2025_03 ( timestamp , actor_id);CREATE INDEX CONCURRENTLY IF NOT EXISTS lrs_statement_04_ts_actor_idx ON acid. lrs_statement_2025_04 ( timestamp , actor_id);CREATE INDEX CONCURRENTLY IF NOT EXISTS lrs_statement_05_ts_actor_idx ON acid. lrs_statement_2025_05 ( timestamp , actor_id);CREATE INDEX CONCURRENTLY IF NOT EXISTS lrs_statement_06_ts_actor_idx ON acid. lrs_statement_2025_06 ( timestamp , actor_id);CREATE INDEX CONCURRENTLY IF NOT EXISTS lrs_statement_07_ts_actor_idx ON acid. lrs_statement_2025_07 ( timestamp , actor_id);-- 2) ë¶€ëª¨ì— íŒŒí‹°ì…˜ë“œ ì¸ë±ìŠ¤ ìƒì„±(ë©”íƒ€ë°ì´í„°; CONCURRENTLY ë¶ˆê°€)CREATE INDEX lrs_statement_ts_actor_idx ON acid. lrs_statement_new ( timestamp , actor_id);-- 3) ìì‹ ì¸ë±ìŠ¤ë“¤ì„ ë¶€ëª¨ ì¸ë±ìŠ¤ì— ATTACHALTER INDEX acid. lrs_statement_ts_actor_idx ATTACH PARTITION lrs_statement_03_ts_actor_idx;ALTER INDEX acid. lrs_statement_ts_actor_idx ATTACH PARTITION lrs_statement_04_ts_actor_idx;ALTER INDEX acid. lrs_statement_ts_actor_idx ATTACH PARTITION lrs_statement_05_ts_actor_idx;ALTER INDEX acid. lrs_statement_ts_actor_idx ATTACH PARTITION lrs_statement_06_ts_actor_idx;ALTER INDEX acid. lrs_statement_ts_actor_idx ATTACH PARTITION lrs_statement_07_ts_actor_idx; ì ì¬ DBCREATE SCHEMA IF NOT EXISTS pipeline;CREATE TABLE IF NOT EXISTS pipeline. aidt_raw (  id UUID,  user_id VARCHAR,  object_type VARCHAR,   statement  JSONB,   timestamp  TIMESTAMPTZ,  inserted_at TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,  flag CHAR(1) DEFAULT 'N',  partner_id TEXT); ìš´ì˜ í™˜ê²½ê³¼ ë™ì¼í•˜ê²Œ ë§ì¶˜ ë¶€ë¶„ vs ì‹¤í—˜ ëª©ì ìœ¼ë¡œ ë°”ê¾¼ ë¶€ë¶„ (í•„ìš”í•œ ì»¬ëŸ¼ë§Œ ë„£ìŒ)3. 2 ìƒ˜í”Œ ì›ì²œ ë°ì´í„° ì´ì „:  ìƒí™©     acid. lrs_statement í…Œì´ë¸”ì€ dumpë¥¼ ëœ° ìˆ˜ ì—†ëŠ” ìƒí™© â‡’ pipeline. aidt_raw ì•ˆì— ìˆ    í•´ê²°     íŒŒì¼ ìƒì„± í›„ bulk update ë³´ë‹¨ DB to DB í†µì‹ ì´ ë¹ ë¥¼ ê²ƒ ê°™ë‹¤ê³  ìƒê°í•´ ì‹¤í–‰ì— ì˜®ê¹€   -- 2-1) FDW í™•ì¥ ì„¤ì¹˜CREATE EXTENSION IF NOT EXISTS postgres_fdw;-- 2-2) ì†ŒìŠ¤ DBë¥¼ ê°€ë¦¬í‚¤ëŠ” ì„œë²„ ê°ì²´ ìƒì„± (ë„ì»¤ ë„¤íŠ¸ì›Œí¬ í˜¸ìŠ¤íŠ¸ëª… ì‚¬ìš©)DROP SERVER IF EXISTS src_srv CASCADE;CREATE SERVER src_srv FOREIGN DATA WRAPPER postgres_fdwOPTIONS (host 'pg_source', port '5432', dbname 'srcdb');-- 2-3) ì¸ì¦ ë§¤í•‘ (ì†ŒìŠ¤ DB ê³„ì •/ë¹„ë²ˆ)CREATE USER MAPPING FOR stguser SERVER src_srvOPTIONS (user 'srcuser', password 'srcpass');-- 2-4) ì™¸ë¶€ í…Œì´ë¸” ê°€ì ¸ì˜¬ ìŠ¤í‚¤ë§ˆ (ë¶„ë¦¬ ê¶Œì¥)CREATE SCHEMA IF NOT EXISTS src_fdw;-- 2-5) í•„ìš”í•œ í…Œì´ë¸”ë§Œ ì„í¬íŠ¸ (ì—¬ê¸°ì„œ source_schema/source_tableì„ ì •í™•íˆ ì§€ì •)IMPORT FOREIGN SCHEMA source_schema LIMIT TO (source_table) FROM SERVER src_srv INTO src_fdw;3. 3 ê· ì¼ ë¶„í¬ ìƒ˜í”Œ ë°ì´í„° ì œì‘: 3. 3. 1 ë°°ê²½:  ì›ë³¸ lrs_statement. insert. sqlì—ëŠ” actor. account. nameì´ íŠ¹ì • ê°’(00066347-5ed0-5305-b2c4-82f28cd72560)ì— ê³¼ë„í•˜ê²Œ ì¹˜ì¤‘.  ë™ì¼í•œ ì´ë¦„ì€ ë™ì¼í•œ actor_idë¥¼ ê°–ê¸° ë•Œë¬¸ì—, ê²°ê³¼ì ìœ¼ë¡œ actor_id ê°’ë„ í¸í–¥ â†’ ì¸ë±ìŠ¤ (actor_id, timestamp) íš¨ìœ¨ ì €í•˜. 3. 3. 2 ëª©í‘œ:  100ê°€ì§€ ì„œë¡œ ë‹¤ë¥¸ actor. account. nameì„ ìƒì„±.  ê° ì´ë¦„ì´ ê· ë“±í•œ ë ˆì½”ë“œ ìˆ˜ë¥¼ ê°–ë„ë¡ ë¶„ë°°.  ë™ì¼í•œ ì´ë¦„ì€ ë™ì¼í•œ actor_id(1~100 ì‚¬ì´ ì •ìˆ˜)ë¥¼ ê°€ì§€ë„ë¡ ë§¤í•‘.  timestamp ë° ë‹¤ë¥¸ í•„ë“œ ê°’ì€ ê·¸ëŒ€ë¡œ ìœ ì§€. 3. 3. 3 ì ˆì°¨:  ì›ë³¸ SQL íŒŒì¼ì—ì„œ INSERT êµ¬ë¬¸ì„ ëª¨ë‘ íŒŒì‹±.  í–‰ ì¸ë±ìŠ¤ ê¸°ì¤€ìœ¼ë¡œ idx % 100 ë°©ì‹ìœ¼ë¡œ 100ê°œì˜ ë²„í‚·ì— ê· ë“± ë¶„ë°°.  ê° ë²„í‚·ì— ëŒ€í•´:     actor. account. nameì„ UUIDv4 í˜•ì‹ìœ¼ë¡œ ìƒˆë¡œ ë¶€ì—¬.    actor_idëŠ” 1~100ê¹Œì§€ì˜ ì •ìˆ˜ë¥¼ ëŒ€ì‘ì‹œí‚´.     JSON ë‚´ë¶€ì—ì„œëŠ” actor. account. nameë§Œ êµì²´, ë‚˜ë¨¸ì§€ êµ¬ì¡°ëŠ” ìœ ì§€.  ìµœì¢…ì ìœ¼ë¡œ ìˆ˜ì •ëœ INSERT êµ¬ë¬¸ë“¤ì„ ìƒˆë¡œìš´ . sql íŒŒì¼ë¡œ ì¶œë ¥. 3. 3. 4 ê²°ê³¼:  100ê°œì˜ ì´ë¦„ì´ ê· ë“±í•˜ê²Œ ë¶„í¬ëœ ìƒ˜í”Œ ë°ì´í„° ìƒì„±.  ì¸ë±ìŠ¤ (actor_id, timestamp)ì˜ ë¶„í¬ ë‹¤ì–‘ì„±ì´ í™•ë³´ë¨.  ì´í›„ ë™ì¼ ë°ì´í„°ë¥¼ timestampë§Œ ë³€ê²½í•˜ì—¬ ëŒ€ìš©ëŸ‰ ë°ì´í„°ì…‹ ìƒì„± ê°€ëŠ¥.    ê°œë°œí•œ DAG task ëª¨ë‘ ì„±ê³µ    3. 4 ëŒ€ìš©ëŸ‰ ìƒ˜í”Œ ë°ì´í„°(8ì²œë§Œ ê±´) ìƒì„± ë° ì ì¬: 3. 4. 1 ë°°ê²½:  AI DT íŒŒì´í”„ë¼ì¸ì˜ 3~7ì›” ë°ì´í„° ì˜ˆìƒ ìµœëŒ€ ì‚°ì •ëŸ‰ = 3ì–µ ê±´â‡’ ì‹œê°„, ì„œë²„ ìì› í—ˆìš© ìˆ˜ì¤€ì—ì„œ ìµœëŒ€í•œ ìœ ì‚¬í•œ ì¡°ê±´ì„ ì¬í˜„3. 4. 2 ë°©ë²• ì„¤ê³„:  íŒë‹¨     ëª¨ë“  ê°’ì„ ë‹¤ ìƒˆë¡­ê²Œ ìƒì„±í•˜ëŠ” ê²ƒì€ ë¹„íš¨ìœ¨ì  â‡’ DB ì•ˆì˜ ê¸°ì¡´ ë ˆì½”ë“œ ë‚´ timestampë§Œ ë³€ê²½í•˜ëŠ” ë™ì‹œ ë³µì œí•˜ì—¬ ìƒ˜í”Œì„ ë»¥íŠ€ê¸°    ê²°ë¡ êµ³ì´ íŒŒì¼ì„ ì“°ëŠ” COPYë¡œ ëŒì•„ê°€ì§€ ë§ê³  INSERT â€¦ SELECT(ë˜ëŠ” CTASâ†’ATTACH)ë¡œ ì§ì ‘ ìì‹ íŒŒí‹°ì…˜ì— ì ì¬í•˜ëŠ” ê²Œ ë” ë¹ ë¥´ê³  ê°„ë‹¨í•©ë‹ˆë‹¤. ì™œëƒë©´,  COPYë¥¼ ì“°ë ¤ë©´ DBâ†’íŒŒì¼(write)â†’DB(read)ë¡œ ì™•ë³µ IOê°€ ì¶”ê°€ë©ë‹ˆë‹¤(íŠ¹íˆ HDDë©´ ë” ì†í•´)     ì›ì²œë„, ëª©í‘œë„ ê°™ì€ DB â†’ íŒŒì¼ ì™•ë³µì´ ìˆœìˆ˜ ì˜¤ë²„í—¤ë“œ   íŒŒì¼ 5ê°œ ë§Œë“¤ê³  ë°˜ë³µ COPYë„ ê°€ëŠ¥í•˜ë‚˜, HDDì—ì„œ íŒŒì¼ IOëŠ” í° ì´ì ì´ ì—†ìŠµë‹ˆë‹¤.     INSERT â€¦ SELECTëŠ” ì—”ì§„ ë‚´ë¶€ì—ì„œ ë°”ë¡œ ì½ê³  ë°”ë¡œ ì”ë‹ˆë‹¤(íŒŒì¼ ì™•ë³µ ì—†ìŒ â‡’ ?)     INSERTâ€¦SELECTëŠ” ë‹¨ì¼ SQLë¡œ ì‹¤í–‰ ê²½ë¡œê°€ ì§§ê³ , íŒŒì´í”„ë¼ì´ë‹/ë²„í¼ë§ì´ íš¨ìœ¨ì     ëŒ€ìš©ëŸ‰ì¼ìˆ˜ë¡ â€œë¶€ëª¨â†’ë¼ìš°íŒ…â€ë³´ë‹¨ ìì‹ íŒŒí‹°ì…˜ì— ì§ì ‘ ì ì¬ê°€ ìœ ë¦¬í•©ë‹ˆë‹¤.      íŒŒí‹°ì…˜ì„ ì´ë¯¸ ì›”ë³„ 5ê°œë¡œ ìƒì„± â†’ ë¼ìš°íŒ… ì˜¤ë²„í—¤ë“œ ë¯¸ë¯¸    PostgreSQL ë‚´ë¶€ ì²˜ë¦¬)ì˜ ì‹¤ì œ ì¥ì :     ë„¤íŠ¸ì›Œí¬ I/O ì œë¡œ: ëª¨ë“  ì²˜ë¦¬ê°€ DB ë‚´ë¶€   ìµœì í™”ëœ ë©”ëª¨ë¦¬ ê´€ë¦¬: PostgreSQLì˜ shared_buffers í™œìš©   íŠ¸ëœì­ì…˜ ì˜¤ë²„í—¤ë“œ ìµœì†Œ: ëŒ€ìš©ëŸ‰ ë‹¨ì¼ íŠ¸ëœì­ì…˜ ê°€ëŠ¥   3. 4. 3 ì ˆì°¨: INSERT INTO acid. lrs_statement_new( timestamp , full_statement, actor_id)SELECT (DATE '2025-03-01' + (floor(random()*153))::int)::timestamptz, s. full_statement, s. actor_idFROM acid. lrs_statement AS sTABLESAMPLE SYSTEM (3. 7) REPEATABLE (1004) -- ê· ì¼ ë¶„í¬ë¥¼ ìœ„í•œ ëœë¤ ìƒ˜í”Œë§LIMIT 1000000;3. 4. 4 ê²°ê³¼:  ìƒì„±+ì ì¬+AUTO VACUUM+WAL+íŠ¸ëœì­ì…˜ ì»¤ë°‹ ì†Œìš” ì‹œê°„ = ìµœì†Œ 20ë¶„ ~ ìµœëŒ€ 1ì‹œê°„ (250ë§Œ ê±´ ê¸°ì¤€)               **ì´ 7,975ë§Œ ê±´     152GB**           4. ë°ì´í„° íŒŒì´í”„ë¼ì¸ êµ¬ì¶• (Airflow)4. 1 DAG êµ¬ì¡° ì„¤ê³„: 4. 1. 1 Extract â†’ Transform â†’ Load ë‹¨ê³„ë³„ êµ¬ì„±:  Extract: SELECT_SQLë¡œ ì›ì²œ í…Œì´ë¸”ì—ì„œ í‚¤ì…‹ í˜ì´ì§€ë„¤ì´ì…˜(ì •ë ¬ í‚¤: timestamp, actor_id)ì„ ì‚¬ìš©í•´ ê³ ì • í¬ê¸°(BATCH_SIZE)ë¡œ ëŠì–´ ì½ìŒ.      ì˜ë„: ì˜¤í”„ì…‹ ê¸°ë°˜ë³´ë‹¤ ì¸ë±ìŠ¤-ì¹œí™”ì ì´ê³  ëŒ€ìš©ëŸ‰ì—ì„œë„ ì„±ëŠ¥ì´ ì„ í˜•ì . ìš´ì˜ ì¸ë±ìŠ¤ (timestamp, actor_id)ë§Œ íƒ€ë„ë¡ WHERE/ORDER BYë¥¼ ì„¤ê³„.     Transform(ê²½ëŸ‰): SELECT ë‹¨ê³„ì—ì„œ í•„ìš”í•œ í•„ë“œë§Œ JSON ì—°ì‚°ìë¡œ ì¦‰ì‹œ ì¶”ì¶œ(full_statement-&gt;. . . ). ì• í”Œë¦¬ì¼€ì´ì…˜ ë‹¨ ë³€í™˜ì€ ìµœì†Œí™”í•´ I/Oë¥¼ ìš°ì„  ë³‘ëª©ìœ¼ë¡œ ë³´ê³  ì²˜ë¦¬ëŸ‰ í™•ë³´.  Load: io. StringIO ë²„í¼ì— ëˆ„ì  í›„ COPY . . . FROM STDINì„ ì²­í¬ ë‹¨ìœ„(COPY_CHUNK)ë¡œ í˜ë ¤ë³´ë‚´ëŠ” ìŠ¤íŠ¸ë¦¬ë° ë¡œë“œ.      ì˜ë„: row-by-row INSERTë³´ë‹¤ ìˆ˜ì‹­ ë°° ë¹ ë¥¸ ê²½í–¥. ë©”ëª¨ë¦¬ ì••ë°•ì„ ë§‰ê¸° ìœ„í•´ ì¤‘ê°„ flush(ì²­í¬) ì„¤ê³„   4. 2 DAG êµ¬í˜„: 4. 2. 1 PythonOperator, PostgresHook í™œìš©:  PythonOperatorë¡œ ì „ì²´ ì›” ë²”ìœ„ë¥¼ ìˆœíšŒ(run_all_months) â†’ 10ì¼ ë‹¨ìœ„ë¡œ ì„¸ë¶„(split_range) â†’ ê° ìœˆë„ìš°ë§ˆë‹¤ run_one_month ì‹¤í–‰.      ì˜ë„: ë¡œì§ì„ íŒŒì´ì¬ì—ì„œ ì œì–´í•˜ë©´ í‚¤ì…‹ í˜ì´ì§€ë„¤ì´ì…˜, ì²­í¬ COPY, ì›Œí„°ë§ˆí¬(ë§ˆì§€ë§‰ (timestamp, actor_id)) ê°™ì€ ì„¸ë°€ ì œì–´ê°€ ì‰¬ì›€.     PostgresHook ë‘ ê°œë¥¼ ì¨ì„œ ì›ì²œ/íƒ€ê¹ƒ ì»¤ë„¥ì…˜ ë¶„ë¦¬. ì»¤ë„¥ì…˜ ë‹¹ ì»¤ì„œ ìˆ˜ëª…ë„ ì§§ê²Œ ì¡ì•„ ë¦¬ì†ŒìŠ¤ ì ìœ  ìµœì†Œí™”.  ë¹ ë¥¸ ì‚¬ì „ ê²€ì¦: EXPLAIN (FORMAT JSON)ìœ¼ë¡œ ì›” ìœˆë„ìš°ì˜ ì˜ˆìƒ rowsë¥¼ ë¡œê·¸ë§Œ ë‚¨ê¹€(ì‹¤ COUNTë¡œ í…Œì´ë¸” í’€ìŠ¤ìº”ì„ í”¼í•¨). 4. 2. 2 task ì„¤ê³„ ë° ì‹¤í–‰ ì£¼ê¸°:  í˜„ ë²„ì „ì€ ë‹¨ì¼ íƒœìŠ¤í¬(run_etl)ë¡œ ì„¤ê³„.      ì˜ë„: ì´ˆê¸° ëŒ€ìš©ëŸ‰ ì´ê´€/ì ì¬ì—ì„œëŠ” ìµœëŒ€ ì²˜ë¦¬ëŸ‰ í™•ë³´ì™€ ì½”ë“œ ë‹¨ìˆœì„±ì„ ìš°ì„ . COPY ìŠ¤íŠ¸ë¦¬ë°ì€ íƒœìŠ¤í¬ ë‚´ë¶€ ë£¨í”„ê°€ ìœ ë¦¬.     ìŠ¤ì¼€ì¤„: í˜„ì¬ schedule=None, max_active_runs=1     ì˜ë„: ìˆ˜ë™ ê¸°ë™/ë¦¬ëŸ° ì‹œ ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€. ëŒ€ëŸ‰ ì´ê´€ ì¢…ë£Œ í›„ì—ëŠ” ì¼ ë°°ì¹˜(ì˜ˆ: @daily)ë¡œ ì „í™˜ ê°€ëŠ¥.    4. 3 ì—ëŸ¬ ëŒ€ì‘ ë° ìµœì í™”: 4. 3. 1 XCom ì—ëŸ¬ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…: Airflow 2. xëŠ” PythonOperatorì˜ ë¦¬í„´ê°’ì„ XComìœ¼ë¡œ ìë™ í‘¸ì‹œ. ëŒ€ìš©ëŸ‰ ì˜¤ë¸Œì íŠ¸(ë¦¬ìŠ¤íŠ¸/ë°ì´í„°í”„ë ˆì„/ë¬¸ìì—´ ë²„í¼)ë¥¼ ë°˜í™˜í•˜ë©´ XCom ì‚¬ì´ì¦ˆ í•œë„ë¥¼ ë„˜ì–´ ì§ë ¬í™”/DB ì—ëŸ¬ê°€ ë°œìƒí•  ìˆ˜ ìˆìŒ. 1) ë¬¸ì œ: íŠ¹ì • íƒœìŠ¤í¬(extract_actor_id_list_task) ì‹¤í–‰ ì‹œ UnmappableXComLengthPushed ì˜ˆì™¸ ë°œìƒ    ì—ëŸ¬ ë¡œê·¸:    airflow. exceptions. UnmappableXComLengthPushed: unmappable return value length: 2031 &gt; 1024      ê²°ê³¼ì ìœ¼ë¡œ ë™ì  ë§¤í•‘(. expand())ì— í•„ìš”í•œ XCom ê°’ì´ ë¹„ì •ìƒìœ¼ë¡œ ì²˜ë¦¬ë˜ì–´ ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ íƒœìŠ¤í¬ ì „ë¶€ê°€ SKIPPED ì²˜ë¦¬ë¨.  2) ì›ì¸  XCom ìë™ ì‚¬ìš©     Airflowì˜ @task ë˜ëŠ” PythonOperator ë°˜í™˜ê°’ì€ ìë™ìœ¼ë¡œ XComì— ì €ì¥ëœë‹¤.    ì½”ë“œì—ì„œ xcom_push, xcom_pullì„ ì§ì ‘ í˜¸ì¶œí•˜ì§€ ì•Šì•„ë„ ë‚´ë¶€ì ìœ¼ë¡œ XComì´ í•­ìƒ ì‚¬ìš©ëœë‹¤.     ë™ì  íƒœìŠ¤í¬ ë§¤í•‘(expand)     ë§¤í•‘ ëŒ€ìƒ ê°’ì€ ë°˜ë“œì‹œ XComì„ í†µí•´ ì „ë‹¬ëœë‹¤.    ì´ ê°’ì˜ ê¸¸ì´ê°€ Airflow ì½”ì–´ ì„¤ì •ê°’ max_map_length(ê¸°ë³¸ 1024)ë¥¼ ì´ˆê³¼í•˜ë©´ ë§¤í•‘ ë¶ˆê°€ëŠ¥ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤.     ì‹¤ì œ ìƒí™©     actor_id ë¦¬ìŠ¤íŠ¸ê°€ 2,031ê°œ ë°˜í™˜ë¨ â†’ ì œí•œ(1024) ì´ˆê³¼   ë”°ë¼ì„œ ìŠ¤ì¼€ì¤„ëŸ¬ê°€ ë§¤í•‘ íƒœìŠ¤í¬ë¥¼ ìƒì„±í•˜ì§€ ëª»í•˜ê³  ì—ëŸ¬ ë°œìƒ   3) í•´ê²° ë°©ë²• ë‹¨í¸ì ì¸ í•´ê²° ë°©ë²•ì´ë¼ê³  ìƒê°í•˜ëŠ” AIRFLOW__CORE__MAX_MAP_LENGTH í™˜ê²½ ë³€ìˆ˜ ì¡°ì •ì€ ì°¨ìˆœìœ„ ë°©ë²•  ê·¼ë³¸ì ì¸ í•´ê²° ë°©ë²•ì´ ì•„ë‹ˆê¸°ì— ë‚˜ì¤‘ì— ë‹¤ë¥¸ ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìˆë‹¤ê³  ìƒê°     íƒœìŠ¤í¬ ì¸ìŠ¤í„´ìŠ¤ ìˆ˜ê°€ ê¸‰ê²©íˆ ëŠ˜ì–´ë‚  ê²½ìš° ìŠ¤ì¼€ì¤„ëŸ¬/ì›Œì»¤ ë¶€í•˜ê°€ ì»¤ì§     environment:  AIRFLOW__CORE__MAX_MAP_LENGTH:  5000    â‡’ ë”°ë¼ì„œ ì½”ë“œ êµ¬ì¡°ë¥¼ ê°œì„ . 1) ì²­í¬ ë‹¨ìœ„ ë°˜í™˜  ë¦¬ìŠ¤íŠ¸ë¥¼ ì˜ê²Œ ë‚˜ëˆ  ë°˜í™˜ â†’ ë§¤í•‘ ê°œìˆ˜ ì¶•ì†ŒCHUNK_SIZE = 200chunks = [actor_ids[i:i+CHUNK_SIZE] for i in range(0, len(actor_ids), CHUNK_SIZE)]return chunks ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ì€ ì²­í¬ ë‹¨ìœ„ íƒœìŠ¤í¬ ì‹¤í–‰2) ì™¸ë¶€ ì €ì¥ì†Œ í™œìš©  ëŒ€ëŸ‰ ë°ì´í„°ëŠ” DB/íŒŒì¼ì— ì €ì¥ XComì—ëŠ” í˜ì´ì§€ ë²ˆí˜¸, ë²”ìœ„ ë“± ì†ŒëŸ‰ ë©”íƒ€ë°ì´í„°ë§Œ ì „ë‹¬3) ë§¤í•‘ ë‹¨ìœ„ ìƒí–¥  ê°œë³„ actor ë‹¨ìœ„ ëŒ€ì‹  actor ê·¸ë£¹/ì²­í¬ ë‹¨ìœ„ íƒœìŠ¤í¬ë¡œ ì¬ì„¤ê³„4. 3. 2 ì¥ì•  ë°œìƒ ëŒ€ì‘ ì „ëµ:  ì›Œí„°ë§ˆí¬ ì¬ì‹œë„: í‚¤ì…‹ í˜ì´ì§€ë„¤ì´ì…˜ì˜ ë§ˆì§€ë§‰ í¬ì¸í„° (last_ts, last_actor_id)ë¥¼ ë¡œê·¸ë¡œ ë‚¨ê²¨ ì¬ê¸°ë™ ì‹œ ì´ì–´ ë°›ê¸° ê°€ëŠ¥     ê¶Œì¥: ë§ˆì§€ë§‰ í¬ì¸í„°ë¥¼ íƒ€ê¹ƒ í…Œì´ë¸” ë˜ëŠ” ë³„ë„ ì²´í¬í¬ì¸íŠ¸ í…Œì´ë¸”ì— ì €ì¥í•´ ì¬ì‹œì‘ ì‹œ ìë™ ë³µêµ¬    íŠ¸ëœì­ì…˜ ê²½ê³„: COPY ì²­í¬ flushë§ˆë‹¤ commit(í˜„ì¬ëŠ” ìœˆë„ìš° ë‚´ 1ì»¤ë°‹)     ëŒ€ëŸ‰ ì ì¬ì—ì„œ ì¥ì•  ë°œìƒ ì‹œ ë¶€ë¶„ ì¬ì²˜ë¦¬ ë²”ìœ„ë¥¼ ì¤„ì´ë ¤ë©´ ì²­í¬ë³„ ì»¤ë°‹ìœ¼ë¡œ ì¡°ì • ê°€ëŠ¥(ëŒ€ì‹  ì»¤ë°‹ ì˜¤ë²„í—¤ë“œ ì¦ê°€)    íƒ€ì…/ìŠ¤í‚¤ë§ˆ ë¯¸ìŠ¤ë§¤ì¹˜(ì‹¤ë¬´ì—ì„œ ìì£¼ ë‚˜ëŠ” ì˜¤ë¥˜)     ì˜ˆ: invalid input syntax for type uuid ë¥˜ â†’ íƒ€ê¹ƒ ì»¬ëŸ¼ íƒ€ì…ê³¼ COPY í…ìŠ¤íŠ¸ ì§ë ¬í™” í¬ë§· ë¶ˆì¼ì¹˜   ëŒ€ì‘: ë²„í¼ì— ì“°ê¸° ì „ ëª¨ë“  í•„ë“œë¥¼ ë¬¸ìì—´ë¡œ ì•ˆì „ ë³€í™˜(íƒ­/ë‰´ë¼ì¸ ì´ìŠ¤ì¼€ì´í”„, None â†’ \N), íƒ€ê¹ƒ ì»¬ëŸ¼ ìˆœì„œì™€ í˜• ë³€í™˜ ëª…ì‹œ. to_char(timestamp, . . . ) ê°™ì€ ì„œë²„ ì‚¬ì´ë“œ ìºìŠ¤íŒ…ì„ SELECTì— í¬í•¨í•˜ë©´ ë” ì•ˆì „    íƒ€ì„ì¡´ ì¼ê´€ì„±     ëª¨ë“  ì»¤ë„¥ì…˜ ì‹œì‘ ì‹œ SET TIME ZONE 'UTC'ë¡œ ê³ ì •. SELECT ì¡°ê±´/ì›Œí„°ë§ˆí¬/ì •ë ¬ì´ ì ˆëŒ€ ì‹œê° ê¸°ì¤€ìœ¼ë¡œ ì¼ì¹˜    ìš´ì˜ ì•ˆì „ì¥ì¹˜     Airflow retries=1, retry_delay=3më¡œ ë‹¨ê¸° ë„¤íŠ¸ì›Œí¬ í”ë“¤ë¦¼ í¡ìˆ˜   ì›ì²œ/íƒ€ê¹ƒ ê°ê° connect_timeout, statement_timeoutë¥¼ Hook ì—°ê²° ë¬¸ìì—´ì— ë¶€ì—¬í•˜ëŠ” ê²ƒë„ ê¶Œì¥   5. Test: ëŒ€ìš©ëŸ‰ ë°ì´í„° ëŒ€ìƒ DAG ì‹¤í–‰5. 1 í…ŒìŠ¤íŠ¸ ëª©ì  ë° ì‹œë‚˜ë¦¬ì˜¤:  DAGë¥¼ í†µí•´ ëŒ€ìš©ëŸ‰ ë°ì´í„°(1ì–µ ê±´) ì ì¬ ì‹œ ì•ˆì •ì ìœ¼ë¡œ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸ Source DB â†’ Stage DBë¡œ Extract-Transform-Load ì „ ê³¼ì • ë¶€í•˜ í…ŒìŠ¤íŠ¸(?) (ìš´ì˜ í™˜ê²½ê³¼ ìœ ì‚¬í•œ) ì£¼ê¸°/ë™ì‹œì„± ì¡°ê±´ì—ì„œì˜ ì„±ëŠ¥ ê²€ì¦5. 2 DAG ì‹¤í–‰ ì¡°ê±´:  ì‹¤í–‰ ì£¼ê¸°: ì—†ìŒ ë³‘ë ¬ ì²˜ë¦¬: CeleryExecutor ê¸°ë°˜ worker ë¶„ì‚° ì‹¤í–‰ ì£¼ìš” íƒœìŠ¤í¬:     Extract (ì›ì²œ DBì—ì„œ í˜ì´ì§•/ì²­í¬ ë‹¨ìœ„ ì¶”ì¶œ)   Transform (JSON íŒŒì‹± ë° actor_id ë§¤í•‘)   Load (Stage DBì— COPY ë°©ì‹ìœ¼ë¡œ ì ì¬)   5. 4 ëª¨ë‹ˆí„°ë§ ë° ê²€ì¦ ë°©ë²•:  ë¡œê·¸ â†’ ë°°ì¹˜ ì²˜ë¦¬ ë° ì ì¬ ì†Œìš” ì‹œê°„, ì²˜ë¦¬ row ìˆ˜, ì—ëŸ¬ í™•ì¸ DB ëª¨ë‹ˆí„°ë§ â†’ pg_stat_activity, ë””ìŠ¤í¬ I/O, ë½ ì¶©ëŒ ì—¬ë¶€ ì„±ëŠ¥ ì§€í‘œ â†’ ì²˜ë¦¬ ì†ë„ (row/s), ì´ ì†Œìš” ì‹œê°„5. 5 ê²°ê³¼ ë° ë¶„ì„:  ì´ ì‹¤í–‰ ì‹œê°„ (ì˜ˆ: 1ì–µ ê±´ ì ì¬ì— N ì‹œê°„ ì†Œìš”)     í•œ ë°°ì¹˜ ë‹¹ ì‹¤í–‰ ì‹œê°„: 8~10ë¶„ â†’ 20ë¶„+ â†’ 40ë¶„ â†’ â€¦   CPU ì ìœ ìœ¨: ì™”ë‹¤ê°”ë‹¤ í–ˆë‹¤ê°€, í›„ë°˜ë¶€ì— ë³´ë‹ˆê¹Œ airflow triggerer ì˜ ì ìœ ìœ¨ì´ ê¾¸ì¤€íˆ 1ë“±    íƒœìŠ¤í¬ë³„ ë³‘ëª© êµ¬ê°„ í™•ì¸ (Extract, Load, â€¦) íŠœë‹ í¬ì¸íŠ¸: ë°°ì¹˜ ë‹¨ìœ„ í¬ê¸°, COPY vs INSERT, íŒŒí‹°ì…”ë‹ ì—¬ë¶€ì˜ ì„±ëŠ¥ ì°¨ì´, ì¸ë±ìŠ¤ì˜ íš¨ê³¼ 5. 6 ê°œì„  ë°©ì•ˆ ë° í•œê³„:  ê°œì„  ë°©ì•ˆ     í˜„ì¬ ê°œì„ ì´ ì•„ë‹Œ ë¬¸ì œ í•´ê²°ì´ í•„ìš”í•œ ìƒí™©    í•œê³„     ë¡œì»¬ í…ŒìŠ¤íŠ¸ í™˜ê²½ê³¼ ìš´ì˜ í™˜ê²½ì˜ DB ì‚¬ì–‘ ì°¨ì´   ë°ì´í„° ë¬´ê²°ì„± ë¬´ì‹œ, í‚¤ ë¯¸ì„¤ì • ex) id/statement_id ë¯¸í• ë‹¹, (timestamp, actor_id)ì˜ ê³ ìœ ì„± ìƒì‹¤         timestampì˜ ë‚ ì§œ ë¿ ì•„ë‹ˆë¼ ì‹œê°„ê¹Œì§€ ëœë¤ ìƒì„±í•´ì•¼ í–ˆìŒ        â‡’ ë°ì´í„° ì¤‘ë³µ ê²€ì‚¬ ë° UPSERT ì²˜ë¦¬ x       6. íšŒê³ 6. 1 ì˜í•œ ì : 6. 2 ì•„ì‰¬ìš´ ì :  ê³¼ì œê°€ ë§‰ì—°íˆ ì‰¬ìš¸ ê±°ë¼ ìƒê°í•˜ì—¬ ì‘ì—… ì‹œê°„ ë¶„ë°°ì— ì‹¤íŒ¨í–ˆë‹¤.      ëŒ€ìš©ëŸ‰ ìƒ˜í”Œ ë°ì´í„° ìƒì„±ê³¼ DAG ì‹¤í–‰ì— ëŒ€í•´ ì¢€ë” ì—¬ëŸ¬ ë²ˆì˜ trial-errorê°€ í•„ìš”í–ˆë‹¤.     DB ì¤‘ê³ ê¸‰ ì§€ì‹&amp;ê²½í—˜ ë¶€ì¬     ì´ë¥¼í…Œë©´ ì ì¬ëŸ‰ì´ ëŠ˜ì–´ë‚ ìˆ˜ë¡ Auto Vacuum, WALì´ ì¡ì•„ë¨¹ëŠ” ì‹œê°„ì´ ëŠ˜ì–´ë‚˜ë©° ì ì¬ ì†ë„ê°€ ëŠë ¤ì§„ë‹¤ëŠ” ê²ƒì„ ì²˜ìŒ ì•Œê²Œ ë¨   6. 3 ë‹¤ìŒ í•  ì¼:  ëª¨ë‹ˆí„°ë§ êµ¬ì¶• í›„ ë³‘ëª© ì›ì¸/ì§€ì  ë°œêµ´, ì œëŒ€ë¡œ ëœ í…ŒìŠ¤íŠ¸ ë° ê¸°ë¡"
    }, {
    "id": 14,
    "url": "http://localhost:4000/magazine/remote-ssh-problem/",
    "title": "VSCode Remote SSH ì ‘ì† ì‹¤íŒ¨ ë¬¸ì œ í•´ê²°",
    "body": "2025/09/04 - ë¬¸ì œ ìƒí™© (ì–´ë–¤ ì˜¤ë¥˜/ì´ìŠˆì˜€ëŠ”ì§€): íšŒì‚¬ì—ì„œ ì‚¬ìš©í•˜ëŠ” AWS EC2 . pem í‚¤ë¥¼ ë°›ì•„ ~/. ssh/configì— í•„ìš”í•œ ì„¤ì •ì„ í•´ì£¼ì—ˆìŒì—ë„ ë¶ˆêµ¬í•˜ê³  ê³„ì† í‚¤ ê¶Œí•œ ë¬¸ì œ ì—ëŸ¬ë¡œ ì¸í•œ Connection fail ë°œìƒ. ì›ì¸ ë¶„ì„: chmod 600 (íŒŒì¼ëª…)ì„ í•´ì¤¬ê³ , ë„¤íŠ¸ì›Œí¬ ì„¤ì •ìƒì˜ ì ‘ê·¼ ê¶Œí•œ ë¬¸ì œ(ì¸ë°”ìš´ë“œ/ì•„ì›ƒë°”ìš´ë“œ ë“±)ê°€ ì—†ëŠ”ë°ë„ ê°™ì€ ë¬¸ì œê°€ ë°œìƒí•œë‹¤ëŠ” ê±´ ë‹¤ë¥¸ ê²Œ ì›ì¸ì´ë¼ëŠ” ê²ƒ. ê·¸ë˜ì„œ ì ‘ì† ì‹¤íŒ¨í•˜ê¸°ê¹Œì§€ì˜ ë¡œê·¸ ì „ì²´ë¥¼ ë¶„ì„ í•´ê²°: IdentityFileì— ì íŒ pemí‚¤ íŒŒì¼ ê²½ë¡œëª…ì„ ìƒëŒ€ ê²½ë¡œê°€ ì•„ë‹Œ ì ˆëŒ€ ê²½ë¡œë¡œ ì •í™•í•˜ê²Œ ëª…ì‹œí–ˆë”ë‹ˆ í•´ê²°ëë‹¤. Host airflow-ec2 HostName (IPì£¼ì†Œ) User ubuntu IdentityFile (pemí‚¤ íŒŒì¼ ê²½ë¡œ)ì£¼ì˜í•  ì  / ëŒ€ì²´ ë°©ë²•:  íŒŒì¼/í´ë” ê²½ë¡œê°€ ë¬¸ì œë˜ëŠ” ë‹¤ë¥¸ ê²½ìš°ë“¤ì—ë„ ì €ëŸ° ì‹ì˜ ë°©ë²•ì´ í†µí•  ë•Œê°€ ìˆì—ˆë‹¤. ì°¸ê³  ìë£Œ (ë§í¬, ë¬¸ì„œ ë“±): ChatGPT5. 0 "
    }, {
    "id": 15,
    "url": "http://localhost:4000/magazine/docker-airflow-uid-problem/",
    "title": "airflow UIDê°€ ìƒì„±?ë˜ì§€ ì•ŠëŠ” ë¬¸ì œ",
    "body": "2025/09/03 - ë¬¸ì œ ìƒí™© (ì–´ë–¤ ì˜¤ë¥˜/ì´ìŠˆì˜€ëŠ”ì§€): docker compose íŒŒì¼ì— user:  ${AIRFLOW_UID:-50000}:0  ë¼ëŠ” ë¶€ë¶„ì´ í¬í•¨ë¼ìˆìŒ. ê·¸ëŸ¼ì—ë„ ë¶ˆêµ¬í•˜ê³  AIRFLOW_UIDê°€ ìƒì„±ë˜ì§€ ì•Šì•„ WARNINGì´ ëœ¨ê³ , ì‹¤ì œ airflow-init ì»¨í…Œì´ë„ˆë¥¼ ë¹„ë¡¯í•˜ì—¬ ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆë¥¼ ë„ìš¸ ë•Œ ì—ëŸ¬ë¥¼ ë³´ì´ë©° airflow êµ¬ë™ì— ì‹¤íŒ¨í•¨. ì›ì¸ ë¶„ì„: í•´ê²° ë°©ë²• (ì½”ë“œ/ëª…ë ¹ì–´ í¬í•¨): í”„ë¡œì íŠ¸ ë£¨íŠ¸(Compose íŒŒì¼ì´ ìˆëŠ” í´ë”)ì— . env íŒŒì¼ì„ ë§Œë“¤ì–´ í•­ìƒ ë¡œë“œë˜ê²Œ í•œë‹¤. echo  AIRFLOW_UID=$(id -u)  &gt; . envì£¼ì˜í•  ì  / ëŒ€ì²´ ë°©ë²•:  ì‹ ê¸°í•œ ê±´, ì‹¤í–‰ í™˜ê²½ì— ë”°ë¼ AIRFLOW_UIDê°€ í•­ìƒ ë‹¬ëë‹¤ëŠ” ê²ƒ.  . envëŠ” ìë™ìœ¼ë¡œ ì½íˆë¯€ë¡œ, ì‰˜ì—ì„œ export ì•ˆ í•´ë„ ë¨ì°¸ê³  ìë£Œ (ë§í¬, ë¬¸ì„œ ë“±): ChatGPT5. 0 "
    }, {
    "id": 16,
    "url": "http://localhost:4000/magazine/welcome-to-jekyll/",
    "title": "Welcome to Jekyll!",
    "body": "2019/02/04 - Youâ€™ll find this post in your _posts directory. Go ahead and edit it and re-build the site to see your changes. You can rebuild the site in many different ways, but the most common way is to run jekyll serve, which launches a web server and auto-regenerates your site when a file is updated. To add new posts, simply add a file in the _posts directory that follows the convention YYYY-MM-DD-name-of-post. ext and includes the necessary front matter. Take a look at the source for this post to get an idea about how it works. Jekyll also offers powerful support for code snippets: def print_hi(name) puts  Hi, #{name} endprint_hi('Tom')#=&gt; prints 'Hi, Tom' to STDOUT. Check out the Jekyll docs for more info on how to get the most out of Jekyll. File all bugs/feature requests at Jekyllâ€™s GitHub repo. If you have questions, you can ask them on Jekyll Talk. "
    }, {
    "id": 17,
    "url": "http://localhost:4000/magazine/powerful-things-markdown-editor/",
    "title": "Powerful things you can do with the Markdown editor",
    "body": "2019/02/03 - There are lots of powerful things you can do with the Markdown editor. If youâ€™ve gotten pretty comfortable with writing in Markdown, then you may enjoy some more advanced tips about the types of things you can do with Markdown! As with the last post about the editor, youâ€™ll want to be actually editing this post as you read it so that you can see all the Markdown code weâ€™re using. Special formatting: As well as bold and italics, you can also use some other special formatting in Markdown when the need arises, for example:  strike through ==highlight== *escaped characters*Writing code blocks: There are two types of code elements which can be inserted in Markdown, the first is inline, and the other is block. Inline code is formatted by wrapping any word or words in back-ticks, like this. Larger snippets of code can be displayed across multiple lines using triple back ticks: . my-link {  text-decoration: underline;}If you want to get really fancy, you can even add syntax highlighting using Rouge.  Reference lists: The quick brown jumped over the lazy. Another way to insert links in markdown is using reference lists. You might want to use this style of linking to cite reference material in a Wikipedia-style. All of the links are listed at the end of the document, so you can maintain full separation between content and its source or reference. Full HTML: Perhaps the best part of Markdown is that youâ€™re never limited to just Markdown. You can write HTML directly in the Markdown editor and it will just work as HTML usually does. No limits! Hereâ€™s a standard YouTube embed code as an example: "
    }, {
    "id": 18,
    "url": "http://localhost:4000/magazine/first-mass-produced/",
    "title": "The first mass-produced book to deviate from a rectilinear format",
    "body": "2019/02/02 - The first mass-produced book to deviate from a rectilinear format, at least in the United States, is thought to be this 1863 edition of Red Riding Hood, cut into the shape of the protagonist herself with the troublesome wolf curled at her feet. Produced by the Boston-based publisher Louis Prang, this is the first in their â€œDoll Seriesâ€, a set of five â€œdie-cutâ€ books, known also as shape books â€” the other titles being Robinson Crusoe, Goody Two-Shoes (also written by Red Riding Hood author Lydia Very), Cinderella, and King Winter. An 1868 Prang catalogue would later claim that such â€œbooks in the shape of a regular paper Dollâ€¦ originated with usâ€.  It would seem the claim could also extend to die cut books in general, as we canâ€™t find anything sooner, but do let us know in the comments if you have further light to shed on this! Such books are, of course, still popular in childrenâ€™s publishing today, though the die cutting is not now limited to mere outlines, as evidenced in a beautiful 2014 version of the same Little Red Riding Hood story. The die cut has also been employed in the non-juvenile sphere as well, a recent example being Jonathan Safran Foerâ€™s ambitious Tree of Codes. As for this particular rendition of Charles Perraultâ€™s classic tale, the text and design is by Lydia Very (1823-1901), sister of Transcendentalist poet Jones Very. The gruesome ending of the original - which sees Little Red Riding Hood being gobbled up as well as her grandmother - is avoided here, the gore giving way to the less bloody aims of the morality tale, and the lesson that one should not disobey oneâ€™s mother. To deviate from a rectilinear format, at least in the United States, is thought to be this 1863 edition of Red Riding Hood, cut into the shape of the protagonist herself with the troublesome wolf curled at her feet. Produced by the Boston-based publisher Louis Prang, this is the first in their â€œDoll Seriesâ€, a set of five â€œdie-cutâ€ books, known also as shape books â€” the other titles being Robinson Crusoe, Goody Two-Shoes (also written by Red Riding Hood author Lydia Very), Cinderella, and King Winter. An 1868 Prang catalogue would later claim that such â€œbooks in the shape of a regular paper Dollâ€¦ originated with usâ€.  The claim could also extend to die cut books in general, as we canâ€™t find anything sooner, but do let us know in the comments if you have further light to shed on this! Such books are, of course, still popular in childrenâ€™s publishing today, though the die cutting is not now limited to mere outlines, as evidenced in a beautiful 2014 version of the same Little Red Riding Hood story. The die cut has also been employed in the non-juvenile sphere as well, a recent example being Jonathan Safran Foerâ€™s ambitious Tree of Codes. As for this particular rendition of Charles Perraultâ€™s classic tale, the text and design is by Lydia Very (1823-1901), sister of Transcendentalist poet Jones Very. The gruesome ending of the original - which sees Little Red Riding Hood being gobbled up as well as her grandmother - is avoided here, the gore giving way to the less bloody aims of the morality tale, and the lesson that one should not disobey oneâ€™s mother. "
    }, {
    "id": 19,
    "url": "http://localhost:4000/magazine/education/",
    "title": "Education must also train one for quick, resolute and effective thinking.",
    "body": "2019/02/01 - There are lots of powerful things you can do with the Markdown editor If youâ€™ve gotten pretty comfortable with writing in Markdown, then you may enjoy some more advanced tips about the types of things you can do with Markdown! As with the last post about the editor, youâ€™ll want to be actually editing this post as you read it so that you can see all the Markdown code weâ€™re using. Special formatting: As well as bold and italics, you can also use some other special formatting in Markdown when the need arises, for example:  strike through ==highlight== *escaped characters*Writing code blocks: There are two types of code elements which can be inserted in Markdown, the first is inline, and the other is block. Inline code is formatted by wrapping any word or words in back-ticks, like this. Larger snippets of code can be displayed across multiple lines using triple back ticks: . my-link {  text-decoration: underline;}If you want to get really fancy, you can even add syntax highlighting using Rouge.  Reference lists: The quick brown jumped over the lazy. Another way to insert links in markdown is using reference lists. You might want to use this style of linking to cite reference material in a Wikipedia-style. All of the links are listed at the end of the document, so you can maintain full separation between content and its source or reference. Full HTML: Perhaps the best part of Markdown is that youâ€™re never limited to just Markdown. You can write HTML directly in the Markdown editor and it will just work as HTML usually does. No limits! Hereâ€™s a standard YouTube embed code as an example: "
    }, {
    "id": 20,
    "url": "http://localhost:4000/magazine/acumulated-experience/",
    "title": "Accumulated experience of social living",
    "body": "2019/01/30 - The die cut has also been employed in the non-juvenile sphere as well, a recent example being Jonathan Safran Foerâ€™s ambitious Tree of Codes. As for this particular rendition of Charles Perraultâ€™s classic tale, the text and design is by Lydia Very (1823-1901), sister of Transcendentalist poet Jones Very. The gruesome ending of the original - which sees Little Red Riding Hood being gobbled up as well as her grandmother - is avoided here, the gore giving way to the less bloody aims of the morality tale, and the lesson that one should not disobey oneâ€™s mother. The first mass-produced book to deviate from a rectilinear format, at least in the United States, is thought to be this 1863 edition of Red Riding Hood, cut into the shape of the protagonist herself with the troublesome wolf curled at her feet. Produced by the Boston-based publisher Louis Prang, this is the first in their â€œDoll Seriesâ€, a set of five â€œdie-cutâ€ books, known also as shape books â€” the other titles being Robinson Crusoe, Goody Two-Shoes (also written by Red Riding Hood author Lydia Very), Cinderella, and King Winter. An 1868 Prang catalogue would later claim that such â€œbooks in the shape of a regular paper Dollâ€¦ originated with usâ€.  It would seem the claim could also extend to die cut books in general, as we canâ€™t find anything sooner, but do let us know in the comments if you have further light to shed on this! Such books are, of course, still popular in childrenâ€™s publishing today, though the die cutting is not now limited to mere outlines, as evidenced in a beautiful 2014 version of the same Little Red Riding Hood story. "
    }, {
    "id": 21,
    "url": "http://localhost:4000/magazine/about-bundler/",
    "title": "About Bundler",
    "body": "2019/01/29 - gem install bundler installs the bundler gem through RubyGems. You only need to install it once - not every time you create a new Jekyll project. Here are some additional details: bundler is a gem that manages other Ruby gems. It makes sure your gems and gem versions are compatible, and that you have all necessary dependencies each gem requires. The Gemfile and Gemfile. lock files inform Bundler about the gem requirements in your site. If your site doesnâ€™t have these Gemfiles, you can omit bundle exec and just run jekyll serve. When you run bundle exec jekyll serve, Bundler uses the gems and versions as specified in Gemfile. lock to ensure your Jekyll site builds with no compatibility or dependency conflicts. For more information about how to use Bundler in your Jekyll project, this tutorial should provide answers to the most common questions and explain how to get up and running quickly. "
    }, {
    "id": 22,
    "url": "http://localhost:4000/magazine/we-all-wait-for-summer/",
    "title": "We all wait for summer",
    "body": "2019/01/28 - This is changed. As I engage in the so-called â€œbull sessionsâ€ around and about the school, I too often find that most college men have a misconception of the purpose of education. Most of the â€œbrethrenâ€ think that education should equip them with the proper instruments of exploitation so that they can forever trample over the masses. Still others think that education should furnish them with noble ends rather than means to an end. It seems to me that education has a two-fold function to perform in the life of man and in society: the one is utility and the other is culture. Education must enable a man to become more efficient, to achieve with increasing facility the ligitimate goals of his life. "
    }, {
    "id": 23,
    "url": "http://localhost:4000/magazine/tree-of-codes/",
    "title": "Tree of Codes",
    "body": "2019/01/27 - The first mass-produced book to deviate from a rectilinear format, at least in the United States, is thought to be this 1863 edition of Red Riding Hood, cut into the shape of the protagonist herself with the troublesome wolf curled at her feet. Produced by the Boston-based publisher Louis Prang, this is the first in their â€œDoll Seriesâ€, a set of five â€œdie-cutâ€ books, known also as shape books â€” the other titles being Robinson Crusoe, Goody Two-Shoes (also written by Red Riding Hood author Lydia Very), Cinderella, and King Winter. As for this particular rendition of Charles Perraultâ€™s classic tale, the text and design is by Lydia Very (1823-1901), sister of Transcendentalist poet Jones Very. The gruesome ending of the original â€” which sees Little Red Riding Hood being gobbled up as well as her grandmother â€” is avoided here, the gore giving way to the less bloody aims of the morality tale, and the lesson that one should not disobey oneâ€™s mother.  It would seem the claim could also extend to die cut books in general, as we canâ€™t find anything sooner, but do let us know in the comments if you have further light to shed on this! Such books are, of course, still popular in childrenâ€™s publishing today, though the die cutting is not now limited to mere outlines, as evidenced in a beautiful 2014 version of the same Little Red Riding Hood story. An 1868 Prang catalogue would later claim that such â€œbooks in the shape of a regular paper Dollâ€¦ originated with usâ€. The die cut has also been employed in the non-juvenile sphere as well, a recent example being Jonathan Safran Foerâ€™s ambitious Tree of Codes. "
    }, {
    "id": 24,
    "url": "http://localhost:4000/magazine/red-riding/",
    "title": "Red Riding Hood",
    "body": "2019/01/26 - The first mass-produced book to deviate from a rectilinear format, at least in the United States, is thought to be this 1863 edition of Red Riding Hood, cut into the shape of the protagonist herself with the troublesome wolf curled at her feet. Produced by the Boston-based publisher Louis Prang, this is the first in their â€œDoll Seriesâ€, a set of five â€œdie-cutâ€ books, known also as shape books â€” the other titles being Robinson Crusoe, Goody Two-Shoes (also written by Red Riding Hood author Lydia Very), Cinderella, and King Winter. An 1868 Prang catalogue would later claim that such â€œbooks in the shape of a regular paper Dollâ€¦ originated with usâ€.  It would seem the claim could also extend to die cut books in general, as we canâ€™t find anything sooner, but do let us know in the comments if you have further light to shed on this! Such books are, of course, still popular in childrenâ€™s publishing today, though the die cutting is not now limited to mere outlines, as evidenced in a beautiful 2014 version of the same Little Red Riding Hood story. The die cut has also been employed in the non-juvenile sphere as well, a recent example being Jonathan Safran Foerâ€™s ambitious Tree of Codes. As for this particular rendition of Charles Perraultâ€™s classic tale, the text and design is by Lydia Very (1823-1901), sister of Transcendentalist poet Jones Very. The gruesome ending of the original â€” which sees Little Red Riding Hood being gobbled up as well as her grandmother â€” is avoided here, the gore giving way to the less bloody aims of the morality tale, and the lesson that one should not disobey oneâ€™s mother. "
    }, {
    "id": 25,
    "url": "http://localhost:4000/magazine/press-and-education/",
    "title": "Press and education",
    "body": "2019/01/25 - Even the press, the classroom, the platform, and the pulpit in many instances do not give us objective and unbiased truths. To save man from the morass of propaganda, in my opinion, is one of the chief aims of education. Education must enable one to sift and weigh evidence, to discern the true from the false, the real from the unreal, and the facts from the fiction. Education must also train one for quick, resolute and effective thinking. To think incisively and to think for oneâ€™s self is very difficult.  We are prone to let our mental life become invaded by legions of half truths, prejudices, and propaganda. At this point, I often wonder whether or not education is fulfilling its purpose. A great majority of the so-called educated people do not think logically and scientifically. The function of education, therefore, is to teach one to think intensively and to think critically. But education which stops with efficiency may prove the greatest menace to society. The most dangerous criminal may be the man gifted with reason, but with no morals. The late Eugene Talmadge, in my opinion, possessed one of the better minds of Georgia, or even America. Moreover, he wore the Phi Beta Kappa key. By all measuring rods, Mr. Talmadge could think critically and intensively; yet he contends that I am an inferior being. Are those the types of men we call educated? We must remember that intelligence is not enough. Intelligence plus characterâ€“that is the goal of true education. The complete education gives one not only power of concentration, but worthy objectives upon which to concentrate. The broad education will, therefore, transmit to one not only the accumulated knowledge of the race but also the accumulated experience of social living. "
    }, {
    "id": 26,
    "url": "http://localhost:4000/magazine/powerful-things-markdown-editor/",
    "title": "Powerful things you can do with the Markdown editor",
    "body": "2019/01/24 - There are lots of powerful things you can do with the Markdown editor If youâ€™ve gotten pretty comfortable with writing in Markdown, then you may enjoy some more advanced tips about the types of things you can do with Markdown! As with the last post about the editor, youâ€™ll want to be actually editing this post as you read it so that you can see all the Markdown code weâ€™re using. Special formatting: As well as bold and italics, you can also use some other special formatting in Markdown when the need arises, for example:  strike through ==highlight== *escaped characters*Writing code blocks: There are two types of code elements which can be inserted in Markdown, the first is inline, and the other is block. Inline code is formatted by wrapping any word or words in back-ticks, like this. Larger snippets of code can be displayed across multiple lines using triple back ticks: . my-link {  text-decoration: underline;}If you want to get really fancy, you can even add syntax highlighting using Rouge.  Reference lists: The quick brown jumped over the lazy. Another way to insert links in markdown is using reference lists. You might want to use this style of linking to cite reference material in a Wikipedia-style. All of the links are listed at the end of the document, so you can maintain full separation between content and its source or reference. Full HTML: Perhaps the best part of Markdown is that youâ€™re never limited to just Markdown. You can write HTML directly in the Markdown editor and it will just work as HTML usually does. No limits! Hereâ€™s a standard YouTube embed code as an example: "
    }, {
    "id": 27,
    "url": "http://localhost:4000/magazine/options-for-creating-new-site-with-jekyll/",
    "title": "Options for creating a new site with Jekyll",
    "body": "2019/01/23 - jekyll new &lt;PATH&gt; installs a new Jekyll site at the path specified (relative to current directory). In this case, Jekyll will be installed in a directory called myblog. Here are some additional details:  To install the Jekyll site into the directory youâ€™re currently in, run jekyll new . If the existing directory isnâ€™t empty, you can pass the â€“force option with jekyll new . â€“force.  jekyll new automatically initiates bundle install to install the dependencies required. (If you donâ€™t want Bundler to install the gems, use jekyll new myblog --skip-bundle. ) By default, the Jekyll site installed by jekyll new uses a gem-based theme called Minima. With gem-based themes, some of the directories and files are stored in the theme-gem, hidden from your immediate view.  We recommend setting up Jekyll with a gem-based theme but if you want to start with a blank slate, use jekyll new myblog --blank To learn about other parameters you can include with jekyll new, type jekyll new --help. "
    }, {
    "id": 28,
    "url": "http://localhost:4000/magazine/never-stopped-worrying-never-loved-bomb/",
    "title": "Never stopped worrying or loving the bomb",
    "body": "2019/01/22 - Iâ€™ve been through fire and water, I tell you! From my earliest pebblehood the wildest things you could imagine have been happening to this world of ours, and I have been right in the midst of them. So begins Hallam Hawksworthâ€™s The Strange Adventures of a Pebble. Written in the 1920s, the book was part of a series which also included The Adventures of a Grain of Dust and A Year in the Wonderland of Trees, all of which were supposed to introduce children to the world of Natural Sciences. In each of them, Hawksworth personifies the natural object he is exploring, and using a mixture of folk tales, scientific facts and colloquial, friendly explanations guides the reader through the history of the natural world. Itâ€™s a real thrill of a ride, dramatizing the life cycle of supposedly dull things. The Adventures of a Grain of Dust begins even more loudly than Pebble: I donâ€™t want you to think that Iâ€™m boasting, but I do believe Iâ€™m one of the greatest travellers that ever was; and if anybody, living or dead, has ever gone through with more than I have Iâ€™d like to hear about it.  Hallam Hawksworth was the pen-name of teacher Francis Blake Atkinson. He was married to the author Eleanor Stackhouse Atkinson, author of the childrenâ€™s classic Greyfriars Bobby, which was based on the (supposedly) true story of a Scottish dog who spent fourteen years guarding his masters grave. The couple were both committed to education and published a weekly magazine for Chicago high school students called The Little Chronicle, as well as working for Encyclopaedia companies later in life. Iâ€™ve been through fire and water, I tell you! From my earliest pebblehood the wildest things you could imagine have been happening to this world of ours, and I have been right in the midst of them. So begins Hallam Hawksworthâ€™s The Strange Adventures of a Pebble. Written in the 1920s, the book was part of a series which also included The Adventures of a Grain of Dust and A Year in the Wonderland of Trees, all of which were supposed to introduce children to the world of Natural Sciences. In each of them, Hawksworth personifies the natural object he is exploring, and using a mixture of folk tales, scientific facts and colloquial, friendly explanations guides the reader through the history of the natural world. Itâ€™s a real thrill of a ride, dramatizing the life cycle of supposedly dull things. The Adventures of a Grain of Dust begins even more loudly than Pebble: I donâ€™t want you to think that Iâ€™m boasting: Hallam Hawksworth was the pen-name of teacher Francis Blake Atkinson. He was married to the author Eleanor Stackhouse Atkinson, author of the childrenâ€™s classic Greyfriars Bobby, which was based on the (supposedly) true story of a Scottish dog who spent fourteen years guarding his masters grave. The couple were both committed to education and published a weekly magazine for Chicago high school students called The Little Chronicle, as well as working for Encyclopaedia companies later in life. Iâ€™ve been through fire and water, I tell you! From my earliest pebblehood the wildest things you could imagine have been happening to this world of ours, and I have been right in the midst of them.  So begins Hallam Hawksworthâ€™s The Strange Adventures of a Pebble. Written in the 1920s, the book was part of a series which also included The Adventures of a Grain of Dust and A Year in the Wonderland of Trees, all of which were supposed to introduce children to the world of Natural Sciences. In each of them, Hawksworth personifies the natural object he is exploring, and using a mixture of folk tales, scientific facts and colloquial, friendly explanations guides the reader through the history of the natural world. Itâ€™s a real thrill of a ride, dramatizing the life cycle of supposedly dull things. The Adventures of a Grain of Dust begins even more loudly than Pebble: I donâ€™t want you to think that Iâ€™m boasting, but I do believe Iâ€™m one of the greatest travellers that ever was; and if anybody, living or dead, has ever gone through with more than I have Iâ€™d like to hear about it. Hallam Hawksworth was the pen-name of teacher Francis Blake Atkinson. He was married to the author Eleanor Stackhouse Atkinson, author of the childrenâ€™s classic Greyfriars Bobby, which was based on the (supposedly) true story of a Scottish dog who spent fourteen years guarding his masters grave. The couple were both committed to education and published a weekly magazine for Chicago high school students called The Little Chronicle, as well as working for Encyclopaedia companies later in life. "
    }, {
    "id": 29,
    "url": "http://localhost:4000/magazine/is-intelligence-enough/",
    "title": "Is Intelligence Enough",
    "body": "2019/01/21 - Education must also train one for quick, resolute and effective thinking. To think incisively and to think for oneâ€™s self is very difficult. We are prone to let our mental life become invaded by legions of half truths, prejudices, and propaganda. At this point, I often wonder whether or not education is fulfilling its purpose. A great majority of the so-called educated people do not think logically and scientifically.  Even the press, the classroom, the platform, and the pulpit in many instances do not give us objective and unbiased truths. To save man from the morass of propaganda, in my opinion, is one of the chief aims of education. Education must enable one to sift and weigh evidence, to discern the true from the false, the real from the unreal, and the facts from the fiction. The function of education, therefore, is to teach one to think intensively and to think critically. But education which stops with efficiency may prove the greatest menace to society. The most dangerous criminal may be the man gifted with reason, but with no morals. The late Eugene Talmadge, in my opinion, possessed one of the better minds of Georgia, or even America. Moreover, he wore the Phi Beta Kappa key. By all measuring rods, Mr. Talmadge could think critically and intensively; yet he contends that I am an inferior being. Are those the types of men we call educated? We must remember that intelligence is not enough. Intelligence plus characterâ€“that is the goal of true education. The complete education gives one not only power of concentration, but worthy objectives upon which to concentrate. The broad education will, therefore, transmit to one not only the accumulated knowledge of the race but also the accumulated experience of social living. "
    }, {
    "id": 30,
    "url": "http://localhost:4000/magazine/quick-start-guide/",
    "title": "Quick Start Guide",
    "body": "2019/01/20 - If you already have a full Ruby development environment with all headers and RubyGems installed (see Jekyllâ€™s requirements), you can create a new Jekyll site by doing the following: # Install Jekyll and Bundler gems through RubyGemsgem install jekyll bundler# Create a new Jekyll site at . /myblogjekyll new myblog# Change into your new directorycd myblog# Build the site on the preview serverbundle exec jekyll serve# Now browse to http://localhost:4000"
    }];

var idx = lunr(function () {
    this.ref('id')
    this.field('title')
    this.field('body')

    documents.forEach(function (doc) {
        this.add(doc)
    }, this)
});


    
function lunr_search(term) {
    $('#lunrsearchresults').show( 1000 );
    $( "body" ).addClass( "modal-open" );
    
    document.getElementById('lunrsearchresults').innerHTML = '<div id="resultsmodal" class="modal fade show d-block"  tabindex="-1" role="dialog" aria-labelledby="resultsmodal"> <div class="modal-dialog shadow-lg" role="document"> <div class="modal-content"> <div class="modal-header" id="modtit"> <button type="button" class="close" id="btnx" data-dismiss="modal" aria-label="Close"> &times; </button> </div> <div class="modal-body"> <ul class="mb-0"> </ul>    </div> <div class="modal-footer"><button id="btnx" type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Close</button></div></div> </div></div>';
    if(term) {
        document.getElementById('modtit').innerHTML = "<h5 class='modal-title'>Search results for '" + term + "'</h5>" + document.getElementById('modtit').innerHTML;
        //put results on the screen.
        var results = idx.search(term);
        if(results.length>0){
            //console.log(idx.search(term));
            //if results
            for (var i = 0; i < results.length; i++) {
                // more statements
                var ref = results[i]['ref'];
                var url = documents[ref]['url'];
                var title = documents[ref]['title'];
                var body = documents[ref]['body'].substring(0,160)+'...';
                document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML + "<li class='lunrsearchresult'><a href='" + url + "'><span class='title'>" + title + "</span><br /><small><span class='body'>"+ body +"</span><br /><span class='url'>"+ url +"</span></small></a></li>";
            }
        } else {
            document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = "<li class='lunrsearchresult'>Sorry, no results found. Close & try a different search!</li>";
        }
    }
    return false;
}
</script>
<style>
    .lunrsearchresult .title {color: #d9230f;}
    .lunrsearchresult .url {color: silver;}
    .lunrsearchresult a {display: block; color: #777;}
    .lunrsearchresult a:hover, .lunrsearchresult a:focus {text-decoration: none;}
    .lunrsearchresult a:hover .title {text-decoration: underline;}
</style>




<form class="bd-search hidden-sm-down" onSubmit="return lunr_search(document.getElementById('lunrsearch').value);">
<input type="text" class="form-control text-small"  id="lunrsearch" name="q" value="" placeholder="Type keyword and enter..."> 
</form>
            </ul>
        </div>
    </div>
    </nav>

    <!-- Search Results -->
    <div id="lunrsearchresults">
        <ul class="mb-0"></ul>
    </div>

    <!-- Content -->
    <main role="main" class="site-content">
        
<div class="container">
<div class="jumbotron jumbotron-fluid mb-3 pl-0 pt-0 pb-0 bg-white position-relative">
		<div class="h-100 tofront">
			<div class="row  justify-content-between ">
				<div class=" col-md-6  pr-0 pr-md-4 pt-4 pb-4 align-self-center">
					<p class="text-uppercase font-weight-bold">
                        <span class="catlist">
						
                          <a class="sscroll text-danger" href="/magazine/categories.html#airflow">airflow</a><span class="sep">, </span>
                        
                          <a class="sscroll text-danger" href="/magazine/categories.html#bigdata">bigdata</a><span class="sep">, </span>
                        
                          <a class="sscroll text-danger" href="/magazine/categories.html#etl">etl</a><span class="sep">, </span>
                        
                          <a class="sscroll text-danger" href="/magazine/categories.html#postgresql">postgresql</a><span class="sep">, </span>
                        
                          <a class="sscroll text-danger" href="/magazine/categories.html#problem solving">problem solving</a><span class="sep">, </span>
                        
                        </span>
					</p>
					<h1 class="display-4 mb-4 article-headline">ìˆ˜ìŠµ ê³¼ì œ: Aì‚¬ 3ì›”~7ì›” ë°ì´í„° adhoc êµ¬ì¶•</h1>
					<div class="d-flex align-items-center">
                        
                        <img class="rounded-circle" src="/magazine//assets/images/avatar2.jpg" alt="Dr.Meteor" width="70"/>
                        
						<small class="ml-3"> Dr.Meteor <span><a target="_blank" href="https://www.linkedin.com/in/wonkyung-kim-007a66189/" class="btn btn-outline-success btn-sm btn-round ml-1">Follow</a></span>
                            <span class="text-muted d-block mt-1">Sep 27, 2025 Â· <span class="reading-time">
  
  
    15 mins read
  
</span>
    </span>
						</small>
					</div>
				</div>
                
				<div class="col-md-6 pr-0 align-self-center">
					<img class="rounded" src="/magazine/assets/images/6.jpg" alt="ìˆ˜ìŠµ ê³¼ì œ: Aì‚¬ 3ì›”~7ì›” ë°ì´í„° adhoc êµ¬ì¶•">
				</div>
                
			</div>
		</div>
	</div>
</div>





<div class="container-lg pt-4 pb-4">
	<div class="row justify-content-center">
        
        
        <!-- Share -->
		<div class="col-lg-2 pr-4 mb-4 col-md-12">
			<div class="sticky-top sticky-top-offset text-center">
				<div class="text-muted">
					Share this
				</div>
				<div class="share d-inline-block">
					<!-- AddToAny BEGIN -->
					<div class="a2a_kit a2a_kit_size_32 a2a_default_style">
						<a class="a2a_dd" href="https://www.addtoany.com/share"></a>
						<a class="a2a_button_facebook"></a>
						<a class="a2a_button_twitter"></a>
					</div>
					<script async src="https://static.addtoany.com/menu/page.js"></script>
					<!-- AddToAny END -->
				</div>
			</div>
		</div>
        
        
		<div class="col-md-12 col-lg-8">
            
            <!-- Article -->
			<article class="article-post">                
			<h1 id="1-í”„ë¡œì íŠ¸-ê°œìš”">1. í”„ë¡œì íŠ¸ ê°œìš”</h1>

<h2 id="11-í”„ë¡œì íŠ¸-ëª©ì ">1.1 í”„ë¡œì íŠ¸ ëª©ì </h2>

<ul>
  <li><strong>ëª©ì </strong>: ìš´ì˜ í™˜ê²½ DBì—ì„œ ?? ì²˜ë¦¬í•˜ê¸°ì—” ë°ì´í„°ê°€ ë„ˆë¬´ ë§ì•„ íŠ¹ì • ê¸°ê°„ì˜ ë°ì´í„°ë¥¼ ì¶”ì¶œ</li>
  <li><strong>ì£¼ìš” Mission</strong>: ì‹œê°„ íš¨ìœ¨ ìµœìš°ì„ . ìš´ì˜ ì¸ë±ìŠ¤(timestamp, actor_id)ì™€ íŒŒí‹°ì…”ë‹ í™œìš©</li>
  <li><strong>êµ¬í˜„ ì „ëµ</strong>: ì›”(íŒŒí‹°ì…˜) ë‹¨ìœ„ â†’ í‚¤ì…‹ í˜ì´ì§€ë„¤ì´ì…˜ â†’ COPY ìŠ¤íŠ¸ë¦¬ë° â†’ íƒ€ê¹ƒì— ì ì¬</li>
  <li><strong>ê²€ì¦</strong>: EXPLAIN rows ì¶”ì •ì¹˜ë§Œ ë¡œê·¸ë¡œ (ê°€ë³ê²Œ)</li>
  <li><strong>ì¤‘ë³µ ì œì–´</strong>: ê¸°ë³¸ OFF(ìµœëŒ€ ì†ë„). í•„ìš” ì‹œ í›„ì²˜ë¦¬ SQL ë³„ë„ ì‹¤í–‰.</li>
</ul>

<h2 id="12-ìˆ˜í–‰-ë²”ìœ„">1.2 ìˆ˜í–‰ ë²”ìœ„</h2>

<h2 id="13-ê¸°ìˆ -ìŠ¤íƒ-ë°-í™˜ê²½">1.3 ê¸°ìˆ  ìŠ¤íƒ ë° í™˜ê²½</h2>

<h1 id="2-sample-test-í™˜ê²½-êµ¬ì„±-ë°-ìš´ì˜">2. Sample Test í™˜ê²½ êµ¬ì„± ë° ìš´ì˜</h1>

<h3 id="21-source-db--stage-db--airflow-ì»¨í…Œì´ë„ˆ-ì •ì˜">2.1 Source DB / Stage DB / Airflow ì»¨í…Œì´ë„ˆ ì •ì˜</h3>

<h3 id="-source-db-ì›ì²œ-db">ğŸ”¹ Source DB (ì›ì²œ DB)</h3>

<ul>
  <li><strong>êµ¬ì„±</strong>: íšŒì‚¬ ë‚´ë¶€ PostgreSQL 16 ì„œë²„ (ì™¸ë¶€ì— ë³„ë„ ì»¨í…Œì´ë„ˆ ì—†ìŒ)</li>
  <li><strong>ì ‘ì†ë°©ì‹</strong>: <code class="language-plaintext highlighter-rouge">SRC_PG_HOST</code>, <code class="language-plaintext highlighter-rouge">SRC_PG_PORT</code>, <code class="language-plaintext highlighter-rouge">SRC_PG_DB</code>, <code class="language-plaintext highlighter-rouge">SRC_PG_USER</code>, <code class="language-plaintext highlighter-rouge">SRC_PG_PASSWORD</code> í™˜ê²½ë³€ìˆ˜ë¡œ ëª¨ë“  ì„œë¹„ìŠ¤ì— ê³µí†µ ì£¼ì…</li>
  <li><strong>Airflow Connection</strong>: <code class="language-plaintext highlighter-rouge">AIRFLOW_CONN_SRC_PG</code> URIë¥¼ í†µí•´ DAG ë‚´ Operatorë“¤ì´ ì ‘ê·¼</li>
</ul>

<h3 id="-stage-db-ì ì¬-db-ë¡œì»¬-ì»¨í…Œì´ë„ˆ">ğŸ”¹ Stage DB (ì ì¬ DB, ë¡œì»¬ ì»¨í…Œì´ë„ˆ)</h3>

<ul>
  <li><strong>êµ¬ì„±</strong>: <code class="language-plaintext highlighter-rouge">pg_stage</code> (Postgres 13 ì»¨í…Œì´ë„ˆ)</li>
  <li><strong>í™˜ê²½ë³€ìˆ˜</strong>: <code class="language-plaintext highlighter-rouge">STG_PG_USER</code>, <code class="language-plaintext highlighter-rouge">STG_PG_PASSWORD</code>, <code class="language-plaintext highlighter-rouge">STG_PG_DB</code></li>
  <li><strong>í¬íŠ¸ ë§¤í•‘</strong>: í˜¸ìŠ¤íŠ¸ 5434 â†’ ì»¨í…Œì´ë„ˆ 5432</li>
  <li><strong>ë°ì´í„° ì €ì¥ì†Œ</strong>: <code class="language-plaintext highlighter-rouge">pg-stage-data</code> ë³¼ë¥¨ ë§ˆìš´íŠ¸</li>
  <li><strong>í—¬ìŠ¤ì²´í¬</strong>: <code class="language-plaintext highlighter-rouge">pg_isready</code> ê¸°ë°˜ DB ì—°ê²° ìƒíƒœ ì ê²€</li>
</ul>

<h3 id="-airflow-êµ¬ì„±-etl-ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜">ğŸ”¹ Airflow êµ¬ì„± (ETL ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜)</h3>

<ul>
  <li><strong>ê³µí†µ ì„¤ì •</strong>: <code class="language-plaintext highlighter-rouge">x-airflow-common</code> ì•µì»¤ ì •ì˜ë¡œ Executor, Broker, Backend, Volumes ë“± ì¼ê´„ ì ìš©
    <ul>
      <li>Executor: <strong>CeleryExecutor</strong></li>
      <li>Broker: <strong>Redis</strong></li>
      <li>Result Backend: <strong>Postgres (airflow ë©”íƒ€DB)</strong></li>
      <li>Volumes: <code class="language-plaintext highlighter-rouge">dags</code>, <code class="language-plaintext highlighter-rouge">logs</code>, <code class="language-plaintext highlighter-rouge">plugins</code>, <code class="language-plaintext highlighter-rouge">config</code> ê³µìœ </li>
    </ul>
  </li>
  <li><strong>ì„œë¹„ìŠ¤ë³„ ì»¨í…Œì´ë„ˆ</strong>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">airflow-webserver</code>: UI ì œê³µ (í¬íŠ¸ 8080)</li>
      <li><code class="language-plaintext highlighter-rouge">airflow-scheduler</code>: DAG ìŠ¤ì¼€ì¤„ë§</li>
      <li><code class="language-plaintext highlighter-rouge">airflow-worker</code>: Celery ê¸°ë°˜ ì‘ì—… ì‹¤í–‰</li>
      <li><code class="language-plaintext highlighter-rouge">airflow-triggerer</code>: ì´ë²¤íŠ¸ ê¸°ë°˜ íŠ¸ë¦¬ê±° ê´€ë¦¬</li>
      <li><code class="language-plaintext highlighter-rouge">airflow-init</code>: ì´ˆê¸° DB ë§ˆì´ê·¸ë ˆì´ì…˜ ë° ê³„ì • ìƒì„±</li>
      <li><code class="language-plaintext highlighter-rouge">airflow-cli</code>: ë””ë²„ê¹…ìš© CLI</li>
      <li><code class="language-plaintext highlighter-rouge">flower</code>: Celery ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ (í¬íŠ¸ 5555)</li>
    </ul>
  </li>
  <li><strong>ì˜ì¡´ì„± ê´€ë¦¬</strong>:
    <ul>
      <li>ëª¨ë“  Airflow ì„œë¹„ìŠ¤ëŠ” <code class="language-plaintext highlighter-rouge">postgres</code>, <code class="language-plaintext highlighter-rouge">redis</code>, <code class="language-plaintext highlighter-rouge">pg-remote-probe</code>, <code class="language-plaintext highlighter-rouge">pg_stage</code> ìƒíƒœì— ë”°ë¼ ê¸°ë™</li>
    </ul>
  </li>
</ul>

<h1 id="3-bigdata-testìš©-db-ê´€ë ¨-ì‘ì—…">3. BigData TESTìš© DB ê´€ë ¨ ì‘ì—…</h1>

<h2 id="31-postgresql-í™˜ê²½-êµ¬ì¶•-ìŠ¤í‚¤ë§ˆ-ë°-í…Œì´ë¸”-ì´ˆê¸°í™”">3.1 PostgreSQL í™˜ê²½ êµ¬ì¶• (ìŠ¤í‚¤ë§ˆ ë° í…Œì´ë¸” ì´ˆê¸°í™”)</h2>

<h3 id="311-dbì„œë²„-ì‹¤í–‰-í™˜ê²½">3.1.1. DBì„œë²„ ì‹¤í–‰ í™˜ê²½</h3>

<ul>
  <li>ì§ì ‘ ì„¤ì¹˜ (ë„ì»¤ ì»¨í…Œì´ë„ˆ ì‚¬ìš© x)</li>
  <li>ì„œë²„ ì‚¬ì–‘
    <ul>
      <li>Ubuntu 24.02, 4Core CPU, 8GB RAM, 500GB <strong>HDD</strong></li>
    </ul>
  </li>
  <li>PostgreSQL 16  <strong><em>(Concern: ìš´ì˜ê³„ DB ë²„ì „ì€ 13ì¸ ê±¸ ê³ ë ¤í•˜ì§€ ëª»í•¨)</em></strong></li>
</ul>

<h3 id="312-db-ì¸ìŠ¤í„´ìŠ¤-ì„¤ì •-ë³€ê²½">3.1.2 DB ì¸ìŠ¤í„´ìŠ¤ ì„¤ì • ë³€ê²½</h3>

<ul>
  <li>data_directory ê²½ë¡œ ë³€ê²½(íšŒì‚¬ íŒŒí‹°ì…˜ ì„œë²„ì„ì„ ê°ì•ˆ), ì™¸ë¶€ ì ‘ì† í—ˆìš©(listen_address), ì‚¬ìš©ì ê³„ì • ìƒì„±</li>
</ul>

<h3 id="313-ìŠ¤í‚¤ë§ˆ-êµ¬ì¡°-ì •ì˜">3.1.3 ìŠ¤í‚¤ë§ˆ êµ¬ì¡° ì •ì˜</h3>

<ul>
  <li>ì›ì²œ DB í…Œì´ë¸”</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">acid</span><span class="p">.</span><span class="n">lrs_statement_new</span> <span class="p">(</span>
  <span class="nv">"timestamp"</span> <span class="n">timestamptz</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="n">full_statement</span> <span class="n">jsonb</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="n">actor_id</span> <span class="nb">bigint</span>
<span class="p">)</span> <span class="k">PARTITION</span> <span class="k">BY</span> <span class="k">RANGE</span> <span class="p">(</span><span class="nv">"timestamp"</span><span class="p">);</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">acid</span><span class="p">.</span><span class="n">lrs_statement_2025_03</span>
  <span class="k">PARTITION</span> <span class="k">OF</span> <span class="n">acid</span><span class="p">.</span><span class="n">lrs_statement_new</span>
  <span class="k">FOR</span> <span class="k">VALUES</span> <span class="k">FROM</span> <span class="p">(</span><span class="s1">'2025-03-01'</span><span class="p">)</span> <span class="k">TO</span> <span class="p">(</span><span class="s1">'2025-04-01'</span><span class="p">);</span>

<span class="p">...</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">acid</span><span class="p">.</span><span class="n">lrs_statement_2025_07</span>
  <span class="k">PARTITION</span> <span class="k">OF</span> <span class="n">acid</span><span class="p">.</span><span class="n">lrs_statement_new</span>
  <span class="k">FOR</span> <span class="k">VALUES</span> <span class="k">FROM</span> <span class="p">(</span><span class="s1">'2025-07-01'</span><span class="p">)</span> <span class="k">TO</span> <span class="p">(</span><span class="s1">'2025-08-01'</span><span class="p">);</span>
</code></pre></div></div>

<ul>
  <li>ì›ì²œ DB ì¸ë±ìŠ¤</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- 1) ìì‹ íŒŒí‹°ì…˜ ì¸ë±ìŠ¤ ìƒì„± (CONCURRENTLY)</span>
<span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">CONCURRENTLY</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="n">lrs_statement_03_ts_actor_idx</span> <span class="k">ON</span> <span class="n">acid</span><span class="p">.</span><span class="n">lrs_statement_2025_03</span> <span class="p">(</span><span class="nv">"timestamp"</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">);</span>
<span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">CONCURRENTLY</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="n">lrs_statement_04_ts_actor_idx</span> <span class="k">ON</span> <span class="n">acid</span><span class="p">.</span><span class="n">lrs_statement_2025_04</span> <span class="p">(</span><span class="nv">"timestamp"</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">);</span>
<span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">CONCURRENTLY</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="n">lrs_statement_05_ts_actor_idx</span> <span class="k">ON</span> <span class="n">acid</span><span class="p">.</span><span class="n">lrs_statement_2025_05</span> <span class="p">(</span><span class="nv">"timestamp"</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">);</span>
<span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">CONCURRENTLY</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="n">lrs_statement_06_ts_actor_idx</span> <span class="k">ON</span> <span class="n">acid</span><span class="p">.</span><span class="n">lrs_statement_2025_06</span> <span class="p">(</span><span class="nv">"timestamp"</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">);</span>
<span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">CONCURRENTLY</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="n">lrs_statement_07_ts_actor_idx</span> <span class="k">ON</span> <span class="n">acid</span><span class="p">.</span><span class="n">lrs_statement_2025_07</span> <span class="p">(</span><span class="nv">"timestamp"</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">);</span>

<span class="c1">-- 2) ë¶€ëª¨ì— íŒŒí‹°ì…˜ë“œ ì¸ë±ìŠ¤ ìƒì„±(ë©”íƒ€ë°ì´í„°; CONCURRENTLY ë¶ˆê°€)</span>
<span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">lrs_statement_ts_actor_idx</span>
  <span class="k">ON</span> <span class="n">acid</span><span class="p">.</span><span class="n">lrs_statement_new</span> <span class="p">(</span><span class="nv">"timestamp"</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">);</span>

<span class="c1">-- 3) ìì‹ ì¸ë±ìŠ¤ë“¤ì„ ë¶€ëª¨ ì¸ë±ìŠ¤ì— ATTACH</span>
<span class="k">ALTER</span> <span class="k">INDEX</span> <span class="n">acid</span><span class="p">.</span><span class="n">lrs_statement_ts_actor_idx</span> <span class="n">ATTACH</span> <span class="k">PARTITION</span> <span class="n">lrs_statement_03_ts_actor_idx</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">INDEX</span> <span class="n">acid</span><span class="p">.</span><span class="n">lrs_statement_ts_actor_idx</span> <span class="n">ATTACH</span> <span class="k">PARTITION</span> <span class="n">lrs_statement_04_ts_actor_idx</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">INDEX</span> <span class="n">acid</span><span class="p">.</span><span class="n">lrs_statement_ts_actor_idx</span> <span class="n">ATTACH</span> <span class="k">PARTITION</span> <span class="n">lrs_statement_05_ts_actor_idx</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">INDEX</span> <span class="n">acid</span><span class="p">.</span><span class="n">lrs_statement_ts_actor_idx</span> <span class="n">ATTACH</span> <span class="k">PARTITION</span> <span class="n">lrs_statement_06_ts_actor_idx</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">INDEX</span> <span class="n">acid</span><span class="p">.</span><span class="n">lrs_statement_ts_actor_idx</span> <span class="n">ATTACH</span> <span class="k">PARTITION</span> <span class="n">lrs_statement_07_ts_actor_idx</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>ì ì¬ DB</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">SCHEMA</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="n">pipeline</span><span class="p">;</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="n">pipeline</span><span class="p">.</span><span class="n">aidt_raw</span> <span class="p">(</span>
    <span class="n">id</span> <span class="n">UUID</span><span class="p">,</span>
    <span class="n">user_id</span> <span class="nb">VARCHAR</span><span class="p">,</span>
    <span class="n">object_type</span> <span class="nb">VARCHAR</span><span class="p">,</span>
    <span class="nv">"statement"</span> <span class="n">JSONB</span><span class="p">,</span>
    <span class="nv">"timestamp"</span> <span class="n">TIMESTAMPTZ</span><span class="p">,</span>
    <span class="n">inserted_at</span> <span class="n">TIMESTAMPTZ</span> <span class="k">DEFAULT</span> <span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
    <span class="n">flag</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="s1">'N'</span><span class="p">,</span>
    <span class="n">partner_id</span> <span class="nb">TEXT</span>
<span class="p">);</span>
</code></pre></div></div>

<ul>
  <li>ìš´ì˜ í™˜ê²½ê³¼ ë™ì¼í•˜ê²Œ ë§ì¶˜ ë¶€ë¶„ vs ì‹¤í—˜ ëª©ì ìœ¼ë¡œ ë°”ê¾¼ ë¶€ë¶„ (í•„ìš”í•œ ì»¬ëŸ¼ë§Œ ë„£ìŒ)</li>
</ul>

<h2 id="32-ìƒ˜í”Œ-ì›ì²œ-ë°ì´í„°-ì´ì „">3.2 ìƒ˜í”Œ ì›ì²œ ë°ì´í„° ì´ì „</h2>

<ul>
  <li>ìƒí™©
    <ul>
      <li>acid.lrs_statement í…Œì´ë¸”ì€ dumpë¥¼ ëœ° ìˆ˜ ì—†ëŠ” ìƒí™© â‡’ pipeline.aidt_raw ì•ˆì— ìˆ</li>
    </ul>
  </li>
  <li>í•´ê²°
    <ul>
      <li>íŒŒì¼ ìƒì„± í›„ bulk update ë³´ë‹¨ DB to DB í†µì‹ ì´ ë¹ ë¥¼ ê²ƒ ê°™ë‹¤ê³  ìƒê°í•´ ì‹¤í–‰ì— ì˜®ê¹€</li>
    </ul>
  </li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- 2-1) FDW í™•ì¥ ì„¤ì¹˜</span>
<span class="k">CREATE</span> <span class="n">EXTENSION</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="n">postgres_fdw</span><span class="p">;</span>

<span class="c1">-- 2-2) ì†ŒìŠ¤ DBë¥¼ ê°€ë¦¬í‚¤ëŠ” ì„œë²„ ê°ì²´ ìƒì„± (ë„ì»¤ ë„¤íŠ¸ì›Œí¬ í˜¸ìŠ¤íŠ¸ëª… ì‚¬ìš©)</span>
<span class="k">DROP</span> <span class="n">SERVER</span> <span class="n">IF</span> <span class="k">EXISTS</span> <span class="n">src_srv</span> <span class="k">CASCADE</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="n">SERVER</span> <span class="n">src_srv</span> <span class="k">FOREIGN</span> <span class="k">DATA</span> <span class="n">WRAPPER</span> <span class="n">postgres_fdw</span>
<span class="k">OPTIONS</span> <span class="p">(</span><span class="k">host</span> <span class="s1">'pg_source'</span><span class="p">,</span> <span class="n">port</span> <span class="s1">'5432'</span><span class="p">,</span> <span class="n">dbname</span> <span class="s1">'srcdb'</span><span class="p">);</span>

<span class="c1">-- 2-3) ì¸ì¦ ë§¤í•‘ (ì†ŒìŠ¤ DB ê³„ì •/ë¹„ë²ˆ)</span>
<span class="k">CREATE</span> <span class="k">USER</span> <span class="n">MAPPING</span> <span class="k">FOR</span> <span class="n">stguser</span> <span class="n">SERVER</span> <span class="n">src_srv</span>
<span class="k">OPTIONS</span> <span class="p">(</span><span class="k">user</span> <span class="s1">'srcuser'</span><span class="p">,</span> <span class="n">password</span> <span class="s1">'srcpass'</span><span class="p">);</span>

<span class="c1">-- 2-4) ì™¸ë¶€ í…Œì´ë¸” ê°€ì ¸ì˜¬ ìŠ¤í‚¤ë§ˆ (ë¶„ë¦¬ ê¶Œì¥)</span>
<span class="k">CREATE</span> <span class="k">SCHEMA</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="n">src_fdw</span><span class="p">;</span>

<span class="c1">-- 2-5) í•„ìš”í•œ í…Œì´ë¸”ë§Œ ì„í¬íŠ¸ (ì—¬ê¸°ì„œ source_schema/source_tableì„ ì •í™•íˆ ì§€ì •)</span>
<span class="n">IMPORT</span> <span class="k">FOREIGN</span> <span class="k">SCHEMA</span> <span class="n">source_schema</span>
  <span class="k">LIMIT</span> <span class="k">TO</span> <span class="p">(</span><span class="n">source_table</span><span class="p">)</span>
  <span class="k">FROM</span> <span class="n">SERVER</span> <span class="n">src_srv</span>
  <span class="k">INTO</span> <span class="n">src_fdw</span><span class="p">;</span>
</code></pre></div></div>

<h2 id="33-ê· ì¼-ë¶„í¬-ìƒ˜í”Œ-ë°ì´í„°-ì œì‘">3.3 ê· ì¼ ë¶„í¬ ìƒ˜í”Œ ë°ì´í„° ì œì‘</h2>

<h3 id="331-ë°°ê²½">3.3.1 ë°°ê²½</h3>

<ul>
  <li>ì›ë³¸ <code class="language-plaintext highlighter-rouge">lrs_statement.insert.sql</code>ì—ëŠ” <code class="language-plaintext highlighter-rouge">actor.account.name</code>ì´ íŠ¹ì • ê°’(<code class="language-plaintext highlighter-rouge">00066347-5ed0-5305-b2c4-82f28cd72560</code>)ì— ê³¼ë„í•˜ê²Œ ì¹˜ì¤‘.</li>
  <li>ë™ì¼í•œ ì´ë¦„ì€ ë™ì¼í•œ <code class="language-plaintext highlighter-rouge">actor_id</code>ë¥¼ ê°–ê¸° ë•Œë¬¸ì—, ê²°ê³¼ì ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">actor_id</code> ê°’ë„ í¸í–¥ â†’ ì¸ë±ìŠ¤ <code class="language-plaintext highlighter-rouge">(actor_id, timestamp)</code> íš¨ìœ¨ ì €í•˜.</li>
</ul>

<h3 id="332-ëª©í‘œ">3.3.2 ëª©í‘œ</h3>

<ul>
  <li>100ê°€ì§€ ì„œë¡œ ë‹¤ë¥¸ <code class="language-plaintext highlighter-rouge">actor.account.name</code>ì„ ìƒì„±.</li>
  <li>ê° ì´ë¦„ì´ ê· ë“±í•œ ë ˆì½”ë“œ ìˆ˜ë¥¼ ê°–ë„ë¡ ë¶„ë°°.</li>
  <li>ë™ì¼í•œ ì´ë¦„ì€ ë™ì¼í•œ <code class="language-plaintext highlighter-rouge">actor_id</code>(1~100 ì‚¬ì´ ì •ìˆ˜)ë¥¼ ê°€ì§€ë„ë¡ ë§¤í•‘.</li>
  <li><code class="language-plaintext highlighter-rouge">timestamp</code> ë° ë‹¤ë¥¸ í•„ë“œ ê°’ì€ ê·¸ëŒ€ë¡œ ìœ ì§€.</li>
</ul>

<h3 id="333-ì ˆì°¨">3.3.3 ì ˆì°¨</h3>

<ol>
  <li>ì›ë³¸ SQL íŒŒì¼ì—ì„œ <code class="language-plaintext highlighter-rouge">INSERT</code> êµ¬ë¬¸ì„ ëª¨ë‘ íŒŒì‹±.</li>
  <li>í–‰ ì¸ë±ìŠ¤ ê¸°ì¤€ìœ¼ë¡œ <strong><code class="language-plaintext highlighter-rouge">idx % 100</code></strong> ë°©ì‹ìœ¼ë¡œ 100ê°œì˜ ë²„í‚·ì— ê· ë“± ë¶„ë°°.</li>
  <li>ê° ë²„í‚·ì— ëŒ€í•´:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">actor.account.name</code>ì„ UUIDv4 í˜•ì‹ìœ¼ë¡œ ìƒˆë¡œ ë¶€ì—¬.</li>
      <li><code class="language-plaintext highlighter-rouge">actor_id</code>ëŠ” 1~100ê¹Œì§€ì˜ ì •ìˆ˜ë¥¼ ëŒ€ì‘ì‹œí‚´.</li>
    </ul>
  </li>
  <li>JSON ë‚´ë¶€ì—ì„œëŠ” <code class="language-plaintext highlighter-rouge">actor.account.name</code>ë§Œ êµì²´, ë‚˜ë¨¸ì§€ êµ¬ì¡°ëŠ” ìœ ì§€.</li>
  <li>ìµœì¢…ì ìœ¼ë¡œ ìˆ˜ì •ëœ <code class="language-plaintext highlighter-rouge">INSERT</code> êµ¬ë¬¸ë“¤ì„ ìƒˆë¡œìš´ <code class="language-plaintext highlighter-rouge">.sql</code> íŒŒì¼ë¡œ ì¶œë ¥.</li>
</ol>

<h3 id="334-ê²°ê³¼">3.3.4 ê²°ê³¼</h3>

<ul>
  <li>100ê°œì˜ ì´ë¦„ì´ ê· ë“±í•˜ê²Œ ë¶„í¬ëœ ìƒ˜í”Œ ë°ì´í„° ìƒì„±.</li>
  <li>ì¸ë±ìŠ¤ <code class="language-plaintext highlighter-rouge">(actor_id, timestamp)</code>ì˜ ë¶„í¬ ë‹¤ì–‘ì„±ì´ í™•ë³´ë¨.</li>
  <li>ì´í›„ ë™ì¼ ë°ì´í„°ë¥¼ timestampë§Œ ë³€ê²½í•˜ì—¬ ëŒ€ìš©ëŸ‰ ë°ì´í„°ì…‹ ìƒì„± ê°€ëŠ¥.</li>
  <li>
    <p>ê°œë°œí•œ DAG task ëª¨ë‘ ì„±ê³µ</p>

    <p><img src="/magazine/assets/images/20.jpg" alt="20.jpg" /></p>
  </li>
</ul>

<h2 id="34-ëŒ€ìš©ëŸ‰-ìƒ˜í”Œ-ë°ì´í„°8ì²œë§Œ-ê±´-ìƒì„±-ë°-ì ì¬">3.4 ëŒ€ìš©ëŸ‰ ìƒ˜í”Œ ë°ì´í„°(8ì²œë§Œ ê±´) ìƒì„± ë° ì ì¬</h2>

<h3 id="341-ë°°ê²½">3.4.1 ë°°ê²½</h3>

<ul>
  <li>AI DT íŒŒì´í”„ë¼ì¸ì˜ 3~7ì›” ë°ì´í„° ì˜ˆìƒ ìµœëŒ€ ì‚°ì •ëŸ‰ = 3ì–µ ê±´
â‡’ ì‹œê°„, ì„œë²„ ìì› í—ˆìš© ìˆ˜ì¤€ì—ì„œ ìµœëŒ€í•œ ìœ ì‚¬í•œ ì¡°ê±´ì„ ì¬í˜„</li>
</ul>

<h3 id="342-ë°©ë²•-ì„¤ê³„">3.4.2 ë°©ë²• ì„¤ê³„</h3>

<ul>
  <li>íŒë‹¨
    <ul>
      <li>ëª¨ë“  ê°’ì„ ë‹¤ ìƒˆë¡­ê²Œ ìƒì„±í•˜ëŠ” ê²ƒì€ ë¹„íš¨ìœ¨ì  â‡’ DB ì•ˆì˜ ê¸°ì¡´ ë ˆì½”ë“œ ë‚´ timestampë§Œ ë³€ê²½í•˜ëŠ” ë™ì‹œ ë³µì œí•˜ì—¬ ìƒ˜í”Œì„ ë»¥íŠ€ê¸°</li>
    </ul>
  </li>
  <li>ê²°ë¡ </li>
</ul>

<p>êµ³ì´ íŒŒì¼ì„ ì“°ëŠ” <strong>COPYë¡œ ëŒì•„ê°€ì§€ ë§ê³  <code class="language-plaintext highlighter-rouge">INSERT â€¦ SELECT</code>(ë˜ëŠ” CTASâ†’ATTACH)ë¡œ ì§ì ‘ ìì‹ íŒŒí‹°ì…˜ì— ì ì¬</strong>í•˜ëŠ” ê²Œ ë” ë¹ ë¥´ê³  ê°„ë‹¨í•©ë‹ˆë‹¤. ì™œëƒë©´,</p>

<ul>
  <li>COPYë¥¼ ì“°ë ¤ë©´ DBâ†’íŒŒì¼(write)â†’DB(read)ë¡œ ì™•ë³µ IOê°€ ì¶”ê°€ë©ë‹ˆë‹¤(íŠ¹íˆ HDDë©´ ë” ì†í•´)
    <ul>
      <li><strong>ì›ì²œë„, ëª©í‘œë„ ê°™ì€ DB</strong> â†’ íŒŒì¼ ì™•ë³µì´ ìˆœìˆ˜ ì˜¤ë²„í—¤ë“œ</li>
      <li>íŒŒì¼ 5ê°œ ë§Œë“¤ê³  ë°˜ë³µ COPYë„ ê°€ëŠ¥í•˜ë‚˜, <strong>HDDì—ì„œ íŒŒì¼ IO</strong>ëŠ” í° ì´ì ì´ ì—†ìŠµë‹ˆë‹¤.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">INSERT â€¦ SELECT</code>ëŠ” <strong>ì—”ì§„ ë‚´ë¶€ì—ì„œ ë°”ë¡œ ì½ê³  ë°”ë¡œ ì”ë‹ˆë‹¤</strong>(íŒŒì¼ ì™•ë³µ ì—†ìŒ â‡’ ?)
    <ul>
      <li>INSERTâ€¦SELECTëŠ” <strong>ë‹¨ì¼ SQL</strong>ë¡œ ì‹¤í–‰ ê²½ë¡œê°€ ì§§ê³ , íŒŒì´í”„ë¼ì´ë‹/ë²„í¼ë§ì´ íš¨ìœ¨ì </li>
    </ul>
  </li>
  <li>ëŒ€ìš©ëŸ‰ì¼ìˆ˜ë¡ â€œë¶€ëª¨â†’ë¼ìš°íŒ…â€ë³´ë‹¨ <strong>ìì‹ íŒŒí‹°ì…˜ì— ì§ì ‘ ì ì¬</strong>ê°€ ìœ ë¦¬í•©ë‹ˆë‹¤.
    <ul>
      <li>íŒŒí‹°ì…˜ì„ ì´ë¯¸ ì›”ë³„ 5ê°œë¡œ ìƒì„± â†’ ë¼ìš°íŒ… ì˜¤ë²„í—¤ë“œ ë¯¸ë¯¸</li>
    </ul>
  </li>
  <li>PostgreSQL ë‚´ë¶€ ì²˜ë¦¬)ì˜ ì‹¤ì œ ì¥ì :
    <ul>
      <li>ë„¤íŠ¸ì›Œí¬ I/O ì œë¡œ: ëª¨ë“  ì²˜ë¦¬ê°€ DB ë‚´ë¶€</li>
      <li>ìµœì í™”ëœ ë©”ëª¨ë¦¬ ê´€ë¦¬: PostgreSQLì˜ shared_buffers í™œìš©</li>
      <li>íŠ¸ëœì­ì…˜ ì˜¤ë²„í—¤ë“œ ìµœì†Œ: ëŒ€ìš©ëŸ‰ ë‹¨ì¼ íŠ¸ëœì­ì…˜ ê°€ëŠ¥</li>
    </ul>
  </li>
</ul>

<h3 id="343-ì ˆì°¨">3.4.3 ì ˆì°¨</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">acid</span><span class="p">.</span><span class="n">lrs_statement_new</span><span class="p">(</span><span class="nv">"timestamp"</span><span class="p">,</span> <span class="n">full_statement</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">)</span>
<span class="k">SELECT</span>
  <span class="p">(</span><span class="nb">DATE</span> <span class="s1">'2025-03-01'</span> <span class="o">+</span> <span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="mi">153</span><span class="p">))::</span><span class="nb">int</span><span class="p">)::</span><span class="n">timestamptz</span><span class="p">,</span>
  <span class="n">s</span><span class="p">.</span><span class="n">full_statement</span><span class="p">,</span>
  <span class="n">s</span><span class="p">.</span><span class="n">actor_id</span>
<span class="k">FROM</span> <span class="n">acid</span><span class="p">.</span><span class="n">lrs_statement</span> <span class="k">AS</span> <span class="n">s</span>
<span class="n">TABLESAMPLE</span> <span class="k">SYSTEM</span> <span class="p">(</span><span class="mi">3</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span> <span class="k">REPEATABLE</span> <span class="p">(</span><span class="mi">1004</span><span class="p">)</span> <span class="c1">-- ê· ì¼ ë¶„í¬ë¥¼ ìœ„í•œ ëœë¤ ìƒ˜í”Œë§</span>
<span class="k">LIMIT</span> <span class="mi">1000000</span><span class="p">;</span>
</code></pre></div></div>

<h3 id="344-ê²°ê³¼">3.4.4 ê²°ê³¼</h3>

<ul>
  <li><strong>ìƒì„±+ì ì¬+AUTO VACUUM+WAL+íŠ¸ëœì­ì…˜ ì»¤ë°‹</strong> ì†Œìš” ì‹œê°„ = ìµœì†Œ 20ë¶„ ~ ìµœëŒ€ 1ì‹œê°„ (250ë§Œ ê±´ ê¸°ì¤€)</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>**ì´ 7,975ë§Œ ê±´</td>
          <td>152GB**</td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<p><img src="/magazine/assets/images/21.png" alt="21.png" /></p>

<h1 id="4-ë°ì´í„°-íŒŒì´í”„ë¼ì¸-êµ¬ì¶•-airflow">4. ë°ì´í„° íŒŒì´í”„ë¼ì¸ êµ¬ì¶• (Airflow)</h1>

<h2 id="41-dag-êµ¬ì¡°-ì„¤ê³„">4.1 DAG êµ¬ì¡° ì„¤ê³„</h2>

<h3 id="411-extract--transform--load-ë‹¨ê³„ë³„-êµ¬ì„±">4.1.1 Extract â†’ Transform â†’ Load ë‹¨ê³„ë³„ êµ¬ì„±</h3>

<ul>
  <li><strong>Extract</strong>: <code class="language-plaintext highlighter-rouge">SELECT_SQL</code>ë¡œ ì›ì²œ í…Œì´ë¸”ì—ì„œ í‚¤ì…‹ í˜ì´ì§€ë„¤ì´ì…˜(ì •ë ¬ í‚¤: <code class="language-plaintext highlighter-rouge">timestamp, actor_id</code>)ì„ ì‚¬ìš©í•´ ê³ ì • í¬ê¸°(<code class="language-plaintext highlighter-rouge">BATCH_SIZE</code>)ë¡œ ëŠì–´ ì½ìŒ.
    <ul>
      <li><strong>ì˜ë„</strong>: ì˜¤í”„ì…‹ ê¸°ë°˜ë³´ë‹¤ ì¸ë±ìŠ¤-ì¹œí™”ì ì´ê³  ëŒ€ìš©ëŸ‰ì—ì„œë„ ì„±ëŠ¥ì´ ì„ í˜•ì . ìš´ì˜ ì¸ë±ìŠ¤ <code class="language-plaintext highlighter-rouge">(timestamp, actor_id)</code>ë§Œ íƒ€ë„ë¡ WHERE/ORDER BYë¥¼ ì„¤ê³„.</li>
    </ul>
  </li>
  <li><strong>Transform(ê²½ëŸ‰)</strong>: SELECT ë‹¨ê³„ì—ì„œ í•„ìš”í•œ í•„ë“œë§Œ JSON ì—°ì‚°ìë¡œ ì¦‰ì‹œ ì¶”ì¶œ(<code class="language-plaintext highlighter-rouge">full_statement-&gt;...</code>). ì• í”Œë¦¬ì¼€ì´ì…˜ ë‹¨ ë³€í™˜ì€ ìµœì†Œí™”í•´ I/Oë¥¼ ìš°ì„  ë³‘ëª©ìœ¼ë¡œ ë³´ê³  ì²˜ë¦¬ëŸ‰ í™•ë³´.</li>
  <li><strong>Load</strong>: <code class="language-plaintext highlighter-rouge">io.StringIO</code> ë²„í¼ì— ëˆ„ì  í›„ <code class="language-plaintext highlighter-rouge">COPY ... FROM STDIN</code>ì„ <strong>ì²­í¬ ë‹¨ìœ„(<code class="language-plaintext highlighter-rouge">COPY_CHUNK</code>)</strong>ë¡œ í˜ë ¤ë³´ë‚´ëŠ” <strong>ìŠ¤íŠ¸ë¦¬ë° ë¡œë“œ</strong>.
    <ul>
      <li><strong>ì˜ë„</strong>: row-by-row <code class="language-plaintext highlighter-rouge">INSERT</code>ë³´ë‹¤ ìˆ˜ì‹­ ë°° ë¹ ë¥¸ ê²½í–¥. ë©”ëª¨ë¦¬ ì••ë°•ì„ ë§‰ê¸° ìœ„í•´ ì¤‘ê°„ flush(ì²­í¬) ì„¤ê³„</li>
    </ul>
  </li>
</ul>

<h2 id="42-dag-êµ¬í˜„">4.2 DAG êµ¬í˜„</h2>

<h3 id="421-pythonoperator-postgreshook-í™œìš©"><strong>4.2.1 PythonOperator, PostgresHook í™œìš©</strong></h3>

<ul>
  <li><strong>PythonOperator</strong>ë¡œ ì „ì²´ ì›” ë²”ìœ„ë¥¼ ìˆœíšŒ(<code class="language-plaintext highlighter-rouge">run_all_months</code>) â†’ 10ì¼ ë‹¨ìœ„ë¡œ ì„¸ë¶„(<code class="language-plaintext highlighter-rouge">split_range</code>) â†’ ê° ìœˆë„ìš°ë§ˆë‹¤ <code class="language-plaintext highlighter-rouge">run_one_month</code> ì‹¤í–‰.
    <ul>
      <li><strong>ì˜ë„</strong>: ë¡œì§ì„ íŒŒì´ì¬ì—ì„œ ì œì–´í•˜ë©´ <strong>í‚¤ì…‹ í˜ì´ì§€ë„¤ì´ì…˜</strong>, <strong>ì²­í¬ COPY</strong>, <strong>ì›Œí„°ë§ˆí¬</strong>(ë§ˆì§€ë§‰ <code class="language-plaintext highlighter-rouge">(timestamp, actor_id)</code>) ê°™ì€ ì„¸ë°€ ì œì–´ê°€ ì‰¬ì›€.</li>
    </ul>
  </li>
  <li><strong>PostgresHook</strong> ë‘ ê°œë¥¼ ì¨ì„œ <strong>ì›ì²œ/íƒ€ê¹ƒ ì»¤ë„¥ì…˜ ë¶„ë¦¬</strong>. ì»¤ë„¥ì…˜ ë‹¹ ì»¤ì„œ ìˆ˜ëª…ë„ ì§§ê²Œ ì¡ì•„ ë¦¬ì†ŒìŠ¤ ì ìœ  ìµœì†Œí™”.</li>
  <li><strong>ë¹ ë¥¸ ì‚¬ì „ ê²€ì¦</strong>: <code class="language-plaintext highlighter-rouge">EXPLAIN (FORMAT JSON)</code>ìœ¼ë¡œ ì›” ìœˆë„ìš°ì˜ ì˜ˆìƒ rowsë¥¼ <strong>ë¡œê·¸ë§Œ ë‚¨ê¹€</strong>(ì‹¤ COUNTë¡œ í…Œì´ë¸” í’€ìŠ¤ìº”ì„ í”¼í•¨).</li>
</ul>

<h3 id="422-task-ì„¤ê³„-ë°-ì‹¤í–‰-ì£¼ê¸°"><strong>4.2.2 task ì„¤ê³„ ë° ì‹¤í–‰ ì£¼ê¸°</strong></h3>

<ul>
  <li>í˜„ ë²„ì „ì€ <strong>ë‹¨ì¼ íƒœìŠ¤í¬</strong>(<code class="language-plaintext highlighter-rouge">run_etl</code>)ë¡œ ì„¤ê³„.
    <ul>
      <li><strong>ì˜ë„</strong>: ì´ˆê¸° ëŒ€ìš©ëŸ‰ ì´ê´€/ì ì¬ì—ì„œëŠ” <strong>ìµœëŒ€ ì²˜ë¦¬ëŸ‰ í™•ë³´</strong>ì™€ <strong>ì½”ë“œ ë‹¨ìˆœì„±</strong>ì„ ìš°ì„ . COPY ìŠ¤íŠ¸ë¦¬ë°ì€ íƒœìŠ¤í¬ ë‚´ë¶€ ë£¨í”„ê°€ ìœ ë¦¬.</li>
    </ul>
  </li>
  <li><strong>ìŠ¤ì¼€ì¤„</strong>: í˜„ì¬ <code class="language-plaintext highlighter-rouge">schedule=None, max_active_runs=1</code>
    <ul>
      <li><strong>ì˜ë„</strong>: ìˆ˜ë™ ê¸°ë™/ë¦¬ëŸ° ì‹œ ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€. ëŒ€ëŸ‰ ì´ê´€ ì¢…ë£Œ í›„ì—ëŠ” ì¼ ë°°ì¹˜(ì˜ˆ: <code class="language-plaintext highlighter-rouge">@daily</code>)ë¡œ ì „í™˜ ê°€ëŠ¥.</li>
    </ul>
  </li>
</ul>

<h2 id="43-ì—ëŸ¬-ëŒ€ì‘-ë°-ìµœì í™”">4.3 ì—ëŸ¬ ëŒ€ì‘ ë° ìµœì í™”</h2>

<h3 id="431-xcom-ì—ëŸ¬-íŠ¸ëŸ¬ë¸”ìŠˆíŒ…"><strong>4.3.1 XCom ì—ëŸ¬ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…</strong></h3>

<p>Airflow 2.xëŠ” <strong>PythonOperatorì˜ ë¦¬í„´ê°’ì„ XComìœ¼ë¡œ ìë™ í‘¸ì‹œ</strong>. ëŒ€ìš©ëŸ‰ ì˜¤ë¸Œì íŠ¸(ë¦¬ìŠ¤íŠ¸/ë°ì´í„°í”„ë ˆì„/ë¬¸ìì—´ ë²„í¼)ë¥¼ ë°˜í™˜í•˜ë©´ XCom ì‚¬ì´ì¦ˆ í•œë„ë¥¼ ë„˜ì–´ <strong>ì§ë ¬í™”/DB ì—ëŸ¬</strong>ê°€ ë°œìƒí•  ìˆ˜ ìˆìŒ.</p>

<p><strong>1) ë¬¸ì œ</strong>: íŠ¹ì • íƒœìŠ¤í¬(<code class="language-plaintext highlighter-rouge">extract_actor_id_list_task</code>) ì‹¤í–‰ ì‹œ <strong><code class="language-plaintext highlighter-rouge">UnmappableXComLengthPushed</code></strong> ì˜ˆì™¸ ë°œìƒ</p>

<ul>
  <li>
    <p>ì—ëŸ¬ ë¡œê·¸:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  airflow.exceptions.UnmappableXComLengthPushed: unmappable return value length: 2031 &gt; 1024
</code></pre></div>    </div>
  </li>
  <li>
    <p>ê²°ê³¼ì ìœ¼ë¡œ ë™ì  ë§¤í•‘(<code class="language-plaintext highlighter-rouge">.expand()</code>)ì— í•„ìš”í•œ XCom ê°’ì´ ë¹„ì •ìƒìœ¼ë¡œ ì²˜ë¦¬ë˜ì–´ ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ íƒœìŠ¤í¬ ì „ë¶€ê°€ SKIPPED ì²˜ë¦¬ë¨.</p>
  </li>
</ul>

<p><strong>2) ì›ì¸</strong></p>

<ul>
  <li><strong>XCom ìë™ ì‚¬ìš©</strong>
    <ul>
      <li>Airflowì˜ <code class="language-plaintext highlighter-rouge">@task</code> ë˜ëŠ” <code class="language-plaintext highlighter-rouge">PythonOperator</code> ë°˜í™˜ê°’ì€ ìë™ìœ¼ë¡œ XComì— ì €ì¥ëœë‹¤.</li>
      <li>ì½”ë“œì—ì„œ <code class="language-plaintext highlighter-rouge">xcom_push</code>, <code class="language-plaintext highlighter-rouge">xcom_pull</code>ì„ ì§ì ‘ í˜¸ì¶œí•˜ì§€ ì•Šì•„ë„ ë‚´ë¶€ì ìœ¼ë¡œ XComì´ í•­ìƒ ì‚¬ìš©ëœë‹¤.</li>
    </ul>
  </li>
  <li><strong>ë™ì  íƒœìŠ¤í¬ ë§¤í•‘(expand)</strong>
    <ul>
      <li>ë§¤í•‘ ëŒ€ìƒ ê°’ì€ ë°˜ë“œì‹œ XComì„ í†µí•´ ì „ë‹¬ëœë‹¤.</li>
      <li>ì´ ê°’ì˜ ê¸¸ì´ê°€ Airflow ì½”ì–´ ì„¤ì •ê°’ <code class="language-plaintext highlighter-rouge">max_map_length</code>(ê¸°ë³¸ 1024)ë¥¼ ì´ˆê³¼í•˜ë©´ ë§¤í•‘ ë¶ˆê°€ëŠ¥ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤.</li>
    </ul>
  </li>
  <li><strong>ì‹¤ì œ ìƒí™©</strong>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">actor_id</code> ë¦¬ìŠ¤íŠ¸ê°€ 2,031ê°œ ë°˜í™˜ë¨ â†’ ì œí•œ(1024) ì´ˆê³¼</li>
      <li>ë”°ë¼ì„œ ìŠ¤ì¼€ì¤„ëŸ¬ê°€ ë§¤í•‘ íƒœìŠ¤í¬ë¥¼ ìƒì„±í•˜ì§€ ëª»í•˜ê³  ì—ëŸ¬ ë°œìƒ</li>
    </ul>
  </li>
</ul>

<p><strong>3) í•´ê²° ë°©ë²•</strong></p>

<p>ë‹¨í¸ì ì¸ í•´ê²° ë°©ë²•ì´ë¼ê³  ìƒê°í•˜ëŠ” <code class="language-plaintext highlighter-rouge">AIRFLOW__CORE__MAX_MAP_LENGTH</code> í™˜ê²½ ë³€ìˆ˜ ì¡°ì •ì€ ì°¨ìˆœìœ„ ë°©ë²•</p>

<ul>
  <li>ê·¼ë³¸ì ì¸ í•´ê²° ë°©ë²•ì´ ì•„ë‹ˆê¸°ì— ë‚˜ì¤‘ì— ë‹¤ë¥¸ ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìˆë‹¤ê³  ìƒê°
    <ul>
      <li>íƒœìŠ¤í¬ ì¸ìŠ¤í„´ìŠ¤ ìˆ˜ê°€ ê¸‰ê²©íˆ ëŠ˜ì–´ë‚  ê²½ìš° ìŠ¤ì¼€ì¤„ëŸ¬/ì›Œì»¤ ë¶€í•˜ê°€ ì»¤ì§</li>
    </ul>

    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="na">environment</span><span class="pi">:</span>
    <span class="na">AIRFLOW__CORE__MAX_MAP_LENGTH</span><span class="pi">:</span> <span class="s2">"</span><span class="s">5000"</span>
</code></pre></div>    </div>
  </li>
</ul>

<p>â‡’ ë”°ë¼ì„œ ì½”ë“œ êµ¬ì¡°ë¥¼ ê°œì„ .</p>

<p><strong>1) ì²­í¬ ë‹¨ìœ„ ë°˜í™˜</strong></p>

<ul>
  <li>ë¦¬ìŠ¤íŠ¸ë¥¼ ì˜ê²Œ ë‚˜ëˆ  ë°˜í™˜ â†’ ë§¤í•‘ ê°œìˆ˜ ì¶•ì†Œ</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">CHUNK_SIZE</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">chunks</span> <span class="o">=</span> <span class="p">[</span><span class="n">actor_ids</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">CHUNK_SIZE</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">actor_ids</span><span class="p">),</span> <span class="n">CHUNK_SIZE</span><span class="p">)]</span>
<span class="k">return</span> <span class="n">chunks</span>
</code></pre></div></div>

<ul>
  <li>ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ì€ ì²­í¬ ë‹¨ìœ„ íƒœìŠ¤í¬ ì‹¤í–‰</li>
</ul>

<p><strong>2) ì™¸ë¶€ ì €ì¥ì†Œ í™œìš©</strong></p>

<ul>
  <li>ëŒ€ëŸ‰ ë°ì´í„°ëŠ” DB/íŒŒì¼ì— ì €ì¥</li>
  <li>XComì—ëŠ” í˜ì´ì§€ ë²ˆí˜¸, ë²”ìœ„ ë“± ì†ŒëŸ‰ ë©”íƒ€ë°ì´í„°ë§Œ ì „ë‹¬</li>
</ul>

<p><strong>3) ë§¤í•‘ ë‹¨ìœ„ ìƒí–¥</strong></p>

<ul>
  <li>ê°œë³„ actor ë‹¨ìœ„ ëŒ€ì‹  actor ê·¸ë£¹/ì²­í¬ ë‹¨ìœ„ íƒœìŠ¤í¬ë¡œ ì¬ì„¤ê³„</li>
</ul>

<h3 id="432-ì¥ì• -ë°œìƒ-ëŒ€ì‘-ì „ëµ"><strong>4.3.2 ì¥ì•  ë°œìƒ ëŒ€ì‘ ì „ëµ</strong></h3>

<ul>
  <li><strong>ì›Œí„°ë§ˆí¬ ì¬ì‹œë„</strong>: í‚¤ì…‹ í˜ì´ì§€ë„¤ì´ì…˜ì˜ ë§ˆì§€ë§‰ í¬ì¸í„° <code class="language-plaintext highlighter-rouge">(last_ts, last_actor_id)</code>ë¥¼ ë¡œê·¸ë¡œ ë‚¨ê²¨ <strong>ì¬ê¸°ë™ ì‹œ ì´ì–´ ë°›ê¸°</strong> ê°€ëŠ¥
    <ul>
      <li>ê¶Œì¥: ë§ˆì§€ë§‰ í¬ì¸í„°ë¥¼ <strong>íƒ€ê¹ƒ í…Œì´ë¸” ë˜ëŠ” ë³„ë„ ì²´í¬í¬ì¸íŠ¸ í…Œì´ë¸”</strong>ì— ì €ì¥í•´ ì¬ì‹œì‘ ì‹œ ìë™ ë³µêµ¬</li>
    </ul>
  </li>
  <li><strong>íŠ¸ëœì­ì…˜ ê²½ê³„</strong>: COPY ì²­í¬ flushë§ˆë‹¤ <code class="language-plaintext highlighter-rouge">commit</code>(í˜„ì¬ëŠ” ìœˆë„ìš° ë‚´ 1ì»¤ë°‹)
    <ul>
      <li>ëŒ€ëŸ‰ ì ì¬ì—ì„œ ì¥ì•  ë°œìƒ ì‹œ <strong>ë¶€ë¶„ ì¬ì²˜ë¦¬</strong> ë²”ìœ„ë¥¼ ì¤„ì´ë ¤ë©´ <strong>ì²­í¬ë³„ ì»¤ë°‹</strong>ìœ¼ë¡œ ì¡°ì • ê°€ëŠ¥(ëŒ€ì‹  ì»¤ë°‹ ì˜¤ë²„í—¤ë“œ ì¦ê°€)</li>
    </ul>
  </li>
  <li><strong>íƒ€ì…/ìŠ¤í‚¤ë§ˆ ë¯¸ìŠ¤ë§¤ì¹˜</strong>(ì‹¤ë¬´ì—ì„œ ìì£¼ ë‚˜ëŠ” ì˜¤ë¥˜)
    <ul>
      <li>ì˜ˆ: <code class="language-plaintext highlighter-rouge">invalid input syntax for type uuid</code> ë¥˜ â†’ <strong>íƒ€ê¹ƒ ì»¬ëŸ¼ íƒ€ì…</strong>ê³¼ COPY í…ìŠ¤íŠ¸ ì§ë ¬í™” í¬ë§· ë¶ˆì¼ì¹˜</li>
      <li>ëŒ€ì‘: ë²„í¼ì— ì“°ê¸° ì „ <strong>ëª¨ë“  í•„ë“œë¥¼ ë¬¸ìì—´ë¡œ ì•ˆì „ ë³€í™˜</strong>(íƒ­/ë‰´ë¼ì¸ ì´ìŠ¤ì¼€ì´í”„, <code class="language-plaintext highlighter-rouge">None â†’ \N</code>), <strong>íƒ€ê¹ƒ ì»¬ëŸ¼ ìˆœì„œ</strong>ì™€ <strong>í˜• ë³€í™˜</strong> ëª…ì‹œ. <code class="language-plaintext highlighter-rouge">to_char(timestamp, ...)</code> ê°™ì€ ì„œë²„ ì‚¬ì´ë“œ ìºìŠ¤íŒ…ì„ SELECTì— í¬í•¨í•˜ë©´ ë” ì•ˆì „</li>
    </ul>
  </li>
  <li><strong>íƒ€ì„ì¡´ ì¼ê´€ì„±</strong>
    <ul>
      <li>ëª¨ë“  ì»¤ë„¥ì…˜ ì‹œì‘ ì‹œ <code class="language-plaintext highlighter-rouge">SET TIME ZONE 'UTC'</code>ë¡œ ê³ ì •. SELECT ì¡°ê±´/ì›Œí„°ë§ˆí¬/ì •ë ¬ì´ <strong>ì ˆëŒ€ ì‹œê°</strong> ê¸°ì¤€ìœ¼ë¡œ ì¼ì¹˜</li>
    </ul>
  </li>
  <li><strong>ìš´ì˜ ì•ˆì „ì¥ì¹˜</strong>
    <ul>
      <li>Airflow <code class="language-plaintext highlighter-rouge">retries=1</code>, <code class="language-plaintext highlighter-rouge">retry_delay=3m</code>ë¡œ <strong>ë‹¨ê¸° ë„¤íŠ¸ì›Œí¬ í”ë“¤ë¦¼</strong> í¡ìˆ˜</li>
      <li>ì›ì²œ/íƒ€ê¹ƒ ê°ê° <strong>connect_timeout</strong>, <strong>statement_timeout</strong>ë¥¼ Hook ì—°ê²° ë¬¸ìì—´ì— ë¶€ì—¬í•˜ëŠ” ê²ƒë„ ê¶Œì¥</li>
    </ul>
  </li>
</ul>

<h1 id="5-test-ëŒ€ìš©ëŸ‰-ë°ì´í„°-ëŒ€ìƒ-dag-ì‹¤í–‰">5. Test: ëŒ€ìš©ëŸ‰ ë°ì´í„° ëŒ€ìƒ DAG ì‹¤í–‰</h1>

<h3 id="51-í…ŒìŠ¤íŠ¸-ëª©ì -ë°-ì‹œë‚˜ë¦¬ì˜¤">5.1 í…ŒìŠ¤íŠ¸ ëª©ì  ë° ì‹œë‚˜ë¦¬ì˜¤</h3>

<ul>
  <li>DAGë¥¼ í†µí•´ ëŒ€ìš©ëŸ‰ ë°ì´í„°(1ì–µ ê±´) ì ì¬ ì‹œ ì•ˆì •ì ìœ¼ë¡œ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸</li>
  <li>Source DB â†’ Stage DBë¡œ Extract-Transform-Load ì „ ê³¼ì • ë¶€í•˜ í…ŒìŠ¤íŠ¸(?)</li>
  <li><em>(ìš´ì˜ í™˜ê²½ê³¼ ìœ ì‚¬í•œ) ì£¼ê¸°/ë™ì‹œì„± ì¡°ê±´ì—ì„œì˜ ì„±ëŠ¥ ê²€ì¦</em></li>
</ul>

<h3 id="52-dag-ì‹¤í–‰-ì¡°ê±´">5.2 DAG ì‹¤í–‰ ì¡°ê±´</h3>

<ul>
  <li>ì‹¤í–‰ ì£¼ê¸°: ì—†ìŒ</li>
  <li>ë³‘ë ¬ ì²˜ë¦¬: CeleryExecutor ê¸°ë°˜ worker ë¶„ì‚° ì‹¤í–‰</li>
  <li>ì£¼ìš” íƒœìŠ¤í¬:
    <ul>
      <li>Extract (ì›ì²œ DBì—ì„œ í˜ì´ì§•/ì²­í¬ ë‹¨ìœ„ ì¶”ì¶œ)</li>
      <li>Transform (JSON íŒŒì‹± ë° actor_id ë§¤í•‘)</li>
      <li>Load (Stage DBì— COPY ë°©ì‹ìœ¼ë¡œ ì ì¬)</li>
    </ul>
  </li>
</ul>

<h3 id="54-ëª¨ë‹ˆí„°ë§-ë°-ê²€ì¦-ë°©ë²•">5.4 ëª¨ë‹ˆí„°ë§ ë° ê²€ì¦ ë°©ë²•</h3>

<ul>
  <li>ë¡œê·¸ â†’ ë°°ì¹˜ ì²˜ë¦¬ ë° ì ì¬ ì†Œìš” ì‹œê°„, ì²˜ë¦¬ row ìˆ˜, ì—ëŸ¬ í™•ì¸</li>
  <li>DB ëª¨ë‹ˆí„°ë§ â†’ <code class="language-plaintext highlighter-rouge">pg_stat_activity</code>, ë””ìŠ¤í¬ I/O, ë½ ì¶©ëŒ ì—¬ë¶€</li>
  <li><em>ì„±ëŠ¥ ì§€í‘œ â†’ ì²˜ë¦¬ ì†ë„ (row/s), ì´ ì†Œìš” ì‹œê°„</em></li>
</ul>

<h3 id="55-ê²°ê³¼-ë°-ë¶„ì„">5.5 ê²°ê³¼ ë° ë¶„ì„</h3>

<ul>
  <li>ì´ ì‹¤í–‰ ì‹œê°„ (ì˜ˆ: 1ì–µ ê±´ ì ì¬ì— N ì‹œê°„ ì†Œìš”)
    <ul>
      <li>í•œ ë°°ì¹˜ ë‹¹ ì‹¤í–‰ ì‹œê°„: 8~10ë¶„ â†’ 20ë¶„+ â†’ 40ë¶„ â†’ â€¦</li>
      <li>CPU ì ìœ ìœ¨: ì™”ë‹¤ê°”ë‹¤ í–ˆë‹¤ê°€, í›„ë°˜ë¶€ì— ë³´ë‹ˆê¹Œ airflow triggerer ì˜ ì ìœ ìœ¨ì´ ê¾¸ì¤€íˆ 1ë“±</li>
    </ul>
  </li>
  <li>íƒœìŠ¤í¬ë³„ ë³‘ëª© êµ¬ê°„ í™•ì¸ (Extract, Load, â€¦)</li>
  <li>íŠœë‹ í¬ì¸íŠ¸: ë°°ì¹˜ ë‹¨ìœ„ í¬ê¸°, COPY vs INSERT, íŒŒí‹°ì…”ë‹ ì—¬ë¶€ì˜ ì„±ëŠ¥ ì°¨ì´, ì¸ë±ìŠ¤ì˜ íš¨ê³¼</li>
</ul>

<p><img src="/magazine/assets/images/22.png" alt="22.png" /></p>

<p><img src="/magazine/assets/images/23.png" alt="23.png" /></p>

<h3 id="56-ê°œì„ -ë°©ì•ˆ-ë°-í•œê³„">5.6 ê°œì„  ë°©ì•ˆ ë° í•œê³„</h3>

<ul>
  <li>ê°œì„  ë°©ì•ˆ
    <ul>
      <li>í˜„ì¬ ê°œì„ ì´ ì•„ë‹Œ ë¬¸ì œ í•´ê²°ì´ í•„ìš”í•œ ìƒí™©</li>
    </ul>
  </li>
  <li>í•œê³„
    <ul>
      <li>ë¡œì»¬ í…ŒìŠ¤íŠ¸ í™˜ê²½ê³¼ ìš´ì˜ í™˜ê²½ì˜ DB ì‚¬ì–‘ ì°¨ì´</li>
      <li>ë°ì´í„° ë¬´ê²°ì„± ë¬´ì‹œ, í‚¤ ë¯¸ì„¤ì •
  ex) id/statement_id ë¯¸í• ë‹¹, (timestamp, actor_id)ì˜ ê³ ìœ ì„± ìƒì‹¤
        <ul>
          <li>timestampì˜ ë‚ ì§œ ë¿ ì•„ë‹ˆë¼ ì‹œê°„ê¹Œì§€ ëœë¤ ìƒì„±í•´ì•¼ í–ˆìŒ</li>
        </ul>

        <p>â‡’ ë°ì´í„° ì¤‘ë³µ ê²€ì‚¬ ë° UPSERT ì²˜ë¦¬ x</p>
      </li>
    </ul>
  </li>
</ul>

<h1 id="6-íšŒê³ ">6. íšŒê³ </h1>

<h2 id="61-ì˜í•œ-ì ">6.1 ì˜í•œ ì </h2>

<h2 id="62-ì•„ì‰¬ìš´-ì ">6.2 ì•„ì‰¬ìš´ ì </h2>

<ul>
  <li>ê³¼ì œê°€ ë§‰ì—°íˆ ì‰¬ìš¸ ê±°ë¼ ìƒê°í•˜ì—¬ ì‘ì—… ì‹œê°„ ë¶„ë°°ì— ì‹¤íŒ¨í–ˆë‹¤.
    <ul>
      <li>ëŒ€ìš©ëŸ‰ ìƒ˜í”Œ ë°ì´í„° ìƒì„±ê³¼ DAG ì‹¤í–‰ì— ëŒ€í•´ ì¢€ë” ì—¬ëŸ¬ ë²ˆì˜ trial-errorê°€ í•„ìš”í–ˆë‹¤.</li>
    </ul>
  </li>
  <li>DB ì¤‘ê³ ê¸‰ ì§€ì‹&amp;ê²½í—˜ ë¶€ì¬
    <ul>
      <li>ì´ë¥¼í…Œë©´ ì ì¬ëŸ‰ì´ ëŠ˜ì–´ë‚ ìˆ˜ë¡ Auto Vacuum, WALì´ ì¡ì•„ë¨¹ëŠ” ì‹œê°„ì´ ëŠ˜ì–´ë‚˜ë©° ì ì¬ ì†ë„ê°€ ëŠë ¤ì§„ë‹¤ëŠ” ê²ƒì„ ì²˜ìŒ ì•Œê²Œ ë¨</li>
    </ul>
  </li>
</ul>

<h2 id="63-ë‹¤ìŒ-í• -ì¼">6.3 ë‹¤ìŒ í•  ì¼</h2>

<ul>
  <li>ëª¨ë‹ˆí„°ë§ êµ¬ì¶• í›„ ë³‘ëª© ì›ì¸/ì§€ì  ë°œêµ´, ì œëŒ€ë¡œ ëœ í…ŒìŠ¤íŠ¸ ë° ê¸°ë¡</li>
</ul>
                
			</article>
			
			<!-- Tags -->
			<div class="mb-4">
				<span class="taglist">
				
				  <a class="sscroll btn btn-light btn-sm font-weight-bold" href="/magazine/tags.html#featured">featured</a>
				
				</span>
			</div>
 
            <!-- Mailchimp Subscribe Form -->
            
			<div class="border p-5 bg-lightblue">
				<div class="row justify-content-between">
					<div class="col-md-6 mb-2 mb-md-0">
						<h5 class="font-weight-bold">Join Newsletter</h5>
						 Get the latest news right in your inbox. We never spam!
					</div>
					<div class="col-md-6">
						<div class="row">
                            <form action="https://wowthemes.us11.list-manage.com/subscribe/post?u=8aeb20a530e124561927d3bd8&amp;id=8c3d2d214b" method="post" name="mc-embedded-subscribe-form" class="wj-contact-form validate w-100" target="_blank" novalidate>
                            <div class="mc-field-group">
							
								<input type="email" placeholder="Enter e-mail address" name="EMAIL" class="required email form-control w-100" id="mce-EMAIL" autocomplete="on" required>
							
							
								<button type="submit" value="Subscribe" name="subscribe" class="heart btn btn-success btn-block w-100 mt-2">Subscribe</button>
							
                            </div>
                            </form>
						</div>
					</div>
				</div>
			</div>
            
            
            
             <!-- Author Box -->
                				
				<div class="row mt-5">
					<div class="col-md-2 align-self-center">
                         
                        <img class="rounded-circle" src="/magazine//assets/images/avatar2.jpg" alt="Dr.Meteor" width="90"/>
                         
					</div>
					<div class="col-md-10">		
                        <h5 class="font-weight-bold">Written by Dr.Meteor <span><a target="_blank" href="https://www.linkedin.com/in/wonkyung-kim-007a66189/" class="btn btn-outline-success btn-sm btn-round ml-2">Follow</a></span></h5>
						Wayfarer who intersects interests: from Humanities to Entertainment					
					</div>
				</div>				
                
            
            <!-- Comments -->
            
                <!--  Don't edit anything here. Set your disqus id in _config.yml -->

<div id="comments" class="mt-5">
    <div id="disqus_thread">
    </div>
    <script type="text/javascript">
        var disqus_shortname = 'demowebsite'; 
        var disqus_developer = 0;
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = window.location.protocol + '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>
    Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
    </noscript>
</div>
            
            
		</div>
        
        
	</div>
</div>


<!-- Aletbar Prev/Next -->
<div class="alertbar">
    <div class="container">
        <div class="row prevnextlinks small font-weight-bold">
          
            <div class="col-md-6 rightborder pl-0">
                <a class="text-dark" href="/magazine/remote-ssh-problem/"> <img height="30px" class="mr-1" src="/magazine/assets/images/2.jpg">  VSCode Remote SSH ì ‘ì† ì‹¤íŒ¨ ë¬¸ì œ í•´ê²°</a>
            </div>
          
          
        </div>
    </div>
</div>

    </main>


    <!-- Scripts: popper, bootstrap, theme, lunr -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

    <script src="/magazine/assets/js/theme.js"></script>


    <!-- Footer -->
    <footer class="bg-white border-top p-3 text-muted small">
        <div class="container">
        <div class="row align-items-center justify-content-between">
            <div>
                <span class="navbar-brand mr-2 mb-0"><strong>Mundana</strong></span>
                <span>Copyright Â© <script>document.write(new Date().getFullYear())</script>.</span>

                <!--  Github Repo Star Btn-->
                <a class="text-dark ml-1" target="_blank" href="https://github.com/wowthemesnet/mundana-theme-jekyll"><i class="fab fa-github"></i> Fork on Github</a>

            </div>
            <div>
                Made with <a target="_blank" class="text-dark font-weight-bold" href="https://www.wowthemes.net/mundana-jekyll-theme/"> Mundana Jekyll Theme </a> by <a class="text-dark" target="_blank" href="https://www.wowthemes.net">WowThemes</a>.
            </div>
        </div>
        </div>
    </footer>

    <!-- All this area goes before </body> closing tag --> 


</body>

</html>
